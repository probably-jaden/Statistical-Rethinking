[
  {
    "objectID": "forkingData.html",
    "href": "forkingData.html",
    "title": "Garden of Forking Data",
    "section": "",
    "text": "This Quarto document is made interactive using Observable JS. Interactive documents allow readers to modify parameters and see the results immediately. Learn more about OJS interactive documents at https://quarto.org/docs/interactive/ojs/."
  },
  {
    "objectID": "forkingData.html#observable-js",
    "href": "forkingData.html#observable-js",
    "title": "Garden of Forking Data",
    "section": "",
    "text": "This Quarto document is made interactive using Observable JS. Interactive documents allow readers to modify parameters and see the results immediately. Learn more about OJS interactive documents at https://quarto.org/docs/interactive/ojs/."
  },
  {
    "objectID": "forkingData.html#bubble-chart",
    "href": "forkingData.html#bubble-chart",
    "title": "Garden of Forking Data",
    "section": "Bubble Chart",
    "text": "Bubble Chart\nThis example uses a D3 bubble chart imported from Observable HQ to analyze commits to GitHub repositories.\nSelect a repository to analyze the commits of:\n\nlibrary(pdftools)\n\nUsing poppler version 23.04.0\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# Extract text\ntext &lt;- pdf_text(\"~/Documents/Intellectual Fun/genericStats/p_hacking.pdf\")\n\n# Convert to tibble for manipulation\npdf_data &lt;- tibble(\n  page = seq_along(text),\n  content = text\n) %&gt;%\n  # Clean up common issues\n  mutate(\n    content = str_replace_all(content, \"\\\\s+\", \" \"),\n    content = str_trim(content)\n  )\n\nwriteLines(pdf_data$content, \"~/Documents/Intellectual Fun/genericStats/p_hacking.txt\")\n\nwrite_file(paste(pdf_data$content, collapse = \"\\n\\n\"), \"~/Documents/Intellectual Fun/genericStats/p_hacking.txt\")\n\n\nviewof repo = Inputs.radio(\n  [\n    \"pandas-dev/pandas\",\n    \"tidyverse/ggplot2\",\n  ], \n  { label: \"Repository:\", value: \"pandas-dev/pandas\"}\n)\n\n\n\n\n\n\nFetch the commits for the specified repo using the GitHub API:\n\nd3 = require('d3')\ncontributors = await d3.json(\n  \"https://api.github.com/repos/\" + repo + \"/stats/contributors\"\n)\ncommits = contributors.map(contributor =&gt; {\n  const author = contributor.author;\n  return {\n    name: author.login,\n    title: author.login,\n    group: author.type,\n    value: contributor.total\n  }\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote that the repo variable is bound dynamically from the radio input defined above. If you change the input the contributors query will be automatically re-executed.\nView the commits sorted by most to least:\n\nInputs.table(commits, { sort: \"value\", reverse: true })\n\n\n\n\n\n\nVisualize using a D3 bubble chart imported from Observable HQ:\n\nimport { chart } with { commits as data } \n  from \"@d3/d3-bubble-chart\"\nchart"
  },
  {
    "objectID": "ch4_linear_regression.html",
    "href": "ch4_linear_regression.html",
    "title": "ch4",
    "section": "",
    "text": "!khun\n\nlibrary(rethinking)\n\nLoading required package: cmdstanr\n\n\nThis is cmdstanr version 0.9.0.9000\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /Users/jaden/.cmdstan/cmdstan-2.36.0\n\n\n- CmdStan version: 2.36.0\n\n\nLoading required package: posterior\n\n\nThis is posterior version 1.6.1\n\n\n\nAttaching package: 'posterior'\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nLoading required package: parallel\n\n\nrethinking (Version 2.42)\n\n\n\nAttaching package: 'rethinking'\n\n\nThe following object is masked from 'package:stats':\n\n    rstudent\n\ndata(Howell1)\nkHeight &lt;- Howell1\n\ndata(\"cherry_blossoms\")\ncherry &lt;- cherry_blossoms\n\nrm(Howell1)\ndetach(package:rethinking, unload = T)\n\nlibrary(splines)\nlibrary(brms)\n\nLoading required package: Rcpp\n\n\nLoading 'brms' package (version 2.22.0). Useful instructions\ncan be found by typing help('brms'). A more detailed introduction\nto the package is available through vignette('brms_overview').\n\n\n\nAttaching package: 'brms'\n\n\nThe following object is masked from 'package:stats':\n\n    ar\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(patchwork)\nlibrary(metR)  # for geom_contour_fill\n\n\nAttaching package: 'metR'\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nsetwd(\"~/Documents/Intellectual Fun/statisticalRethinking/statisticalRethinking\")"
  },
  {
    "objectID": "ch4_linear_regression.html#first-model",
    "href": "ch4_linear_regression.html#first-model",
    "title": "ch4",
    "section": "",
    "text": "!khun\n\nlibrary(rethinking)\n\nLoading required package: cmdstanr\n\n\nThis is cmdstanr version 0.9.0.9000\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /Users/jaden/.cmdstan/cmdstan-2.36.0\n\n\n- CmdStan version: 2.36.0\n\n\nLoading required package: posterior\n\n\nThis is posterior version 1.6.1\n\n\n\nAttaching package: 'posterior'\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nLoading required package: parallel\n\n\nrethinking (Version 2.42)\n\n\n\nAttaching package: 'rethinking'\n\n\nThe following object is masked from 'package:stats':\n\n    rstudent\n\ndata(Howell1)\nkHeight &lt;- Howell1\n\ndata(\"cherry_blossoms\")\ncherry &lt;- cherry_blossoms\n\nrm(Howell1)\ndetach(package:rethinking, unload = T)\n\nlibrary(splines)\nlibrary(brms)\n\nLoading required package: Rcpp\n\n\nLoading 'brms' package (version 2.22.0). Useful instructions\ncan be found by typing help('brms'). A more detailed introduction\nto the package is available through vignette('brms_overview').\n\n\n\nAttaching package: 'brms'\n\n\nThe following object is masked from 'package:stats':\n\n    ar\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(patchwork)\nlibrary(metR)  # for geom_contour_fill\n\n\nAttaching package: 'metR'\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nsetwd(\"~/Documents/Intellectual Fun/statisticalRethinking/statisticalRethinking\")"
  },
  {
    "objectID": "ch4_linear_regression.html#eda-kung-height-weight-gender",
    "href": "ch4_linear_regression.html#eda-kung-height-weight-gender",
    "title": "ch4",
    "section": "EDA !Kung Height ~ Weight + Gender",
    "text": "EDA !Kung Height ~ Weight + Gender\n\nkHeight_adult &lt;- kHeight %&gt;%\n  filter(age &gt;= 18)\n\nkHeight_child &lt;- kHeight %&gt;%\n  filter(age &lt; 18)\n\nggplot(data = kHeight, aes(x = weight, y = height, color = as.factor(male)))+\n  geom_point(alpha = .7)+\n  labs(x= \"Weight (kg)\", y = \"Height (cm)\", \n       title = \"Kung! Height vs Weight\", subtitle = \"By Gender\")+\n  scale_color_discrete(name = \"Gender\", labels = c(\"Female\", \"Male\"))\n\n\n\n\n\n\n\nggplot(data = kHeight_adult, aes(x = weight, y = height, color = as.factor(male)))+\n  geom_point(alpha = .7)+\n  labs(x= \"Weight (kg)\", y = \"Adult Height (cm)\", \n       title = \"Kung! Adult Height vs Weight\", subtitle = \"By Gender\")+\n  scale_color_discrete(name = \"Gender\", labels = c(\"Female\", \"Male\"))\n\n\n\n\n\n\n\nggplot(data = kHeight_child, aes(x = weight, y = height, color = as.factor(male)))+\n  geom_point(alpha = .7)+\n  labs(x= \"Weight (kg)\", y = \"Child Height (cm)\", \n       title = \"Kung! Child Height vs Weight\", subtitle = \"By Gender\")+\n  scale_color_discrete(name = \"Gender\", labels = c(\"Female\", \"Male\"))\n\n\n\n\n\n\n\n\n\nPlotting the Prior\n\n# mean prior\nggplot(data = tibble(x = seq(from = 100, to = 250, by = .1)), \n       aes(x = x, y = dnorm(x, mean = 178, sd = 20))) +\n  scale_y_continuous(NULL, breaks = NULL) +\n  geom_line() +\n  labs(title = \"Prior Mean for Height\", x = \"Height (cm)\", y = \"density\")\n\n\n\n\n\n\n\n# posterior distribution of height prior and mean\nn &lt;- 1e5\ntibble(sample_mu    = rnorm(n, mean = 178,       sd  = 20),\n       sample_sigma = runif(n, min  = 0,         max = 50)) %&gt;% \n  mutate(x = rnorm(n, mean = sample_mu, sd  = sample_sigma)) %&gt;% \n  ggplot() +\n  geom_density(aes(x = x, color = \"prior height distribution\"), linewidth = 1, adjust = 2) +\n  geom_density(aes(x = sample_mu, color = \"prior mean\"), linewidth = 1, adjust = 2) +\n  scale_color_manual(values = c(\"prior height distribution\" = \"black\", \"prior mean\" = \"red\")) +\n  scale_y_continuous(breaks = NULL) +\n  labs(subtitle = expression(Prior~predictive~distribution~\"for\"~italic(h[i])),\n       x = \"Height (cm)\", y = \"Density\",\n       color = NULL) +  # removes legend title\n  theme(panel.grid = element_blank())\n\n\n\n\n\n\n\n\n\n\nGrid approximation technique\n\nn &lt;- 200\n\nd_grid &lt;-\n  # we'll accomplish with `tidyr::crossing()` what McElreath did with base R `expand.grid()`\n  crossing(mu    = seq(from = 130, to = 180, length.out = n),\n           sigma = seq(from = 0,   to = 15,   length.out = n))\n\n\ngrid_function &lt;- function(mu, sigma) {\n  dnorm(kHeight_adult$height, mean = mu, sd = sigma, log = T) %&gt;% \n    sum()\n}\n\nd_grid &lt;-\n  d_grid %&gt;% \n  mutate(log_likelihood = map2(mu, sigma, grid_function)) %&gt;%\n  unnest(log_likelihood) %&gt;% \n  mutate(prior_mu    = dnorm(mu,    mean = 150, sd  = 10, log = T),\n         prior_sigma = dunif(sigma, min  = 0,   max = 10, log = T),\n         product = log_likelihood + prior_mu + prior_sigma,\n         probability = exp(product- max(product)),\n         prior_product = prior_mu + prior_sigma,\n         prior_probability = exp(prior_product - max(prior_product)))\n\nprior_grid &lt;- \n  tibble(prior_mu = log(rnorm(1e5, mean = 150, sd = 10)),\n         prior_sigma = log(runif(1e5, min = 0, max = 10))) %&gt;% \n  mutate(product = prior_mu + prior_sigma,\n         probability = exp(product - max(product)))\n\nprior_plot &lt;- ggplot(data = d_grid) +\n  geom_point(aes(x = mu, y = sigma, color = prior_probability), alpha = .1) +\n  theme(panel.grid = element_blank()) +\n  scale_color_viridis_c(name = \"Prior Probability\", option = \"A\") +\n  labs(title = \"Prior\")\n  \nposterior_plot &lt;- ggplot(data = d_grid) +\n  geom_point(aes(x = mu, y = sigma, color = probability), alpha = .5) +\n   theme(panel.grid = element_blank()) +\n  scale_color_viridis_c(name = \"Posterior Probability\",  option = \"A\") +\n  labs(title = \"Posterior\")\n\nprior_plot + posterior_plot + plot_layout(guides = \"collect\")\n\n\n\n\n\n\n\n\n\nggplot(d_grid) +\n  geom_point(aes(x = mu, y = sigma, color = \"Prior\", alpha = prior_probability)) +\n  geom_point(aes(x = mu, y = sigma, color = \"Posterior\", alpha = probability)) +\n  scale_color_manual(values = c(\"Prior\" = \"blue\", \"Posterior\" = \"red\")) +\n  scale_alpha(name = \"Normalized Likelihood\", range = c(0, 0.6)) +\n  labs(title = \"Prior vs Posterior\", color = \"Distribution\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nSample from the Posterior\n\nd_grid_samples &lt;- \n  d_grid %&gt;% \n  sample_n(size = 1e4, replace = T, weight = probability)\n\nd_grid_samples %&gt;% \n  ggplot(aes(x = mu, y = sigma)) + \n  geom_point(size = 0.9, alpha = 1/15) +\n  scale_fill_viridis_c() +\n  labs(x = expression(mu[samples]),\n       y = expression(sigma[samples])) +\n  theme(panel.grid = element_blank())\n\n\n\n\n\n\n\n\n\n\nmodel intercept only\n\nb4.1 &lt;- \n  brm(data = kHeight_adult, \n      family = gaussian,\n      height ~ 1,\n      prior = c(prior(normal(178, 20), class = Intercept),\n                prior(uniform(0, 50), class = sigma, ub = 50)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      backend = \"cmdstanr\", seed = 4, file = \"fits/b04.011\")\n\nplot(b4.1) \n\nLoading required package: rstan\n\n\nLoading required package: StanHeaders\n\n\n\nrstan version 2.32.7 (Stan version 2.32.2)\n\n\nFor execution on a local, multicore CPU with excess RAM we recommend calling\noptions(mc.cores = parallel::detectCores()).\nTo avoid recompilation of unchanged Stan programs, we recommend calling\nrstan_options(auto_write = TRUE)\nFor within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,\nchange `threads_per_chain` option:\nrstan_options(threads_per_chain = 1)\n\n\n\nAttaching package: 'rstan'\n\n\nThe following object is masked from 'package:tidyr':\n\n    extract\n\n\nThe following objects are masked from 'package:posterior':\n\n    ess_bulk, ess_tail\n\n\n\n\n\n\n\n\n\n\nExtremely Narrow Priors\n\nb4.2 &lt;- \n  brm(data = kHeight_adult, family = gaussian,\n      height ~ 1,\n      prior = c(prior(normal(150, 2), class = Intercept),\n                prior(uniform(0, 6), class = sigma, lb = 0, ub = 6)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      seed = 4, backend = \"cmdstanr\", silent = 2,\n      file = \"fits/b04.02.6\")\n\nplot(b4.2)\n\n\n\n\n\n\n\nb4.2_draws &lt;- as_draws_df(b4.2)\n\n\nb4.2_draws &lt;- b4.2_draws %&gt;% \n  mutate(prior_mu = rnorm(n(), 150, 2),\n         prior_sigma = runif(n(), 0, 6))\n\nggplot(b4.2_draws, ) +\n  geom_point(aes(x = b_Intercept, y = sigma), alpha = 0.05, color = \"blue\") +\n  geom_density_2d(aes(x = b_Intercept, y = sigma), color = \"blue\", bins = 5) +\n  geom_point(aes(x = prior_mu, y = prior_sigma), alpha = 0.05, color = \"red\") +\n  geom_density_2d(aes(x = prior_mu, y = prior_sigma), color = \"red\", bins = 5) +\n  labs(x = expression(mu), y = expression(sigma),\n       title = \"Posterior Contours of mu and sigma\") +\n  theme_minimal()"
  },
  {
    "objectID": "ch4_linear_regression.html#adding-linear-predictor",
    "href": "ch4_linear_regression.html#adding-linear-predictor",
    "title": "ch4",
    "section": "Adding Linear Predictor",
    "text": "Adding Linear Predictor\n\nkHeight_adult &lt;- \n  kHeight_adult %&gt;%\n  mutate(weight_c = weight - mean(weight))\n\nb4.3 &lt;- \n  brm(data = kHeight_adult, \n      family = gaussian,\n      height ~ 1 + weight_c,\n      prior = c(prior(normal(178, 100), class = Intercept),\n                prior(normal(0, 10), class = b),\n                prior(uniform(0, 50), class = sigma, ub = 50)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      seed = 4, backend = \"cmdstanr\", silent = 2,\n      file = \"fits/b04.03.2\")\n\nas_draws_df(b4.3) %&gt;%\n  select(b_Intercept:sigma) %&gt;%\n  cor() %&gt;%\n  round(digits = 2)\n\nWarning: Dropping 'draws_df' class as required metadata was removed.\n\n\n            b_Intercept b_weight_c sigma\nb_Intercept        1.00      -0.04  0.02\nb_weight_c        -0.04       1.00  0.01\nsigma              0.02       0.01  1.00\n\npairs(b4.3)\n\n\n\n\n\n\n\n\n\nmu &lt;- fitted(b4.3, summary = F)\n\n# new data\nweight_seq &lt;- tibble(weight_c = seq(from = -18, to = 18, by = 1))\n\nmu &lt;-\n  fitted(b4.3,\n         summary = F,\n         newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  # here we name the columns after the `weight` values from which they were computed\n  set_names(-18:18) %&gt;% \n  mutate(iter = 1:n())\n\nWarning: The `x` argument of `as_tibble.matrix()` must have unique column names if\n`.name_repair` is omitted as of tibble 2.0.0.\nℹ Using compatibility `.name_repair`.\n\nmu &lt;-  mu %&gt;%\n  gather(weight, height, -iter) %&gt;% \n  # we might reformat `weight` to numerals\n  mutate(weight = as.numeric(weight))\n\nggplot()+\n  geom_point(data = mu, aes(x = weight, y = height), alpha = .002, color = \"blue\")+\n  geom_point(data = kHeight_adult, aes(x = weight_c, y = height))\n\n\n\n\n\n\n\n\n\nplot prediction error\n\npred_height &lt;-\n  predict(b4.3,\n          newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(weight_seq)\n  \npred_height %&gt;%\n  slice(1:6)\n\n# A tibble: 6 × 5\n  Estimate Est.Error  Q2.5 Q97.5 weight_c\n     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1     138.      5.14  128.  148.      -18\n2     139.      5.11  129.  150.      -17\n3     140.      5.13  130.  150.      -16\n4     141.      5.09  131.  151.      -15\n5     142.      5.24  132.  153.      -14\n6     143.      5.16  132.  153.      -13"
  },
  {
    "objectID": "ch4_linear_regression.html#model-and-plot-quadratic-kung-height",
    "href": "ch4_linear_regression.html#model-and-plot-quadratic-kung-height",
    "title": "ch4",
    "section": "model and plot Quadratic !Kung height",
    "text": "model and plot Quadratic !Kung height\n\nkHeight &lt;-\n  kHeight %&gt;%\n  mutate(weight_s = (weight - mean(weight)) / sd(weight))\n\nb4.5 &lt;- \n  brm(data = kHeight, \n      family = gaussian,\n      height ~ 1 + weight_s + I(weight_s^2),\n      prior = c(prior(normal(178, 100), class = Intercept),\n                prior(normal(0, 10), class = b),\n                prior(uniform(0, 50), class = sigma, ub = 50)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      backend = \"cmdstanr\", silent = 2, seed = 4,\n      file = \"fits/b04.05.1.1\")\n\nweight_seq &lt;- tibble(weight_s = seq(from = min(kHeight$weight_s) - (0.5 * sd(kHeight$weight_s)),\n                                    to = max(kHeight$weight_s) + (0.5 * sd(kHeight$weight_s)), \n                                    length.out = 30))\n\nf &lt;-\n  fitted(b4.5, \n         newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(weight_seq)\n\np &lt;-\n  predict(b4.5, \n          newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(weight_seq) \n\nggplot(data = kHeight, \n       aes(x = weight_s)) +\n  geom_ribbon(data = p, \n              aes(ymin = Q2.5, ymax = Q97.5),\n              fill = \"grey83\") +\n  geom_smooth(data = f,\n              aes(y = Estimate, ymin = Q2.5, ymax = Q97.5),\n              stat = \"identity\",\n              fill = \"grey70\", color = \"black\", alpha = 1, linewidth = 1/2) +\n  geom_point(aes(y = height),\n             color = \"navyblue\", shape = 1, size = 1.5, alpha = 1/3) +\n  coord_cartesian(xlim = range(kHeight$weight_s)) +\n  theme(text = element_text(family = \"Times\"),\n        panel.grid = element_blank())\n\n\n\n\n\n\n\n\n\npolynomial (Cubic) model !Kung height\n\nb4.6 &lt;- \n  brm(data = kHeight, \n      family = gaussian,\n      height ~ 1 + weight_s + I(weight_s^2) + I(weight_s^3),\n      prior = c(prior(normal(178, 100), class = Intercept),\n                prior(normal(0, 10), class = b),\n                prior(uniform(0, 50), class = sigma, ub = 50)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      backend = \"cmdstanr\", silent = 2,\n      seed = 4,\n      file = \"fits/b04.06\")\n\n\n# can't remember why I fit this model, I don't remember it being in the book\nb4.7 &lt;- \n  brm(data = kHeight, \n      family = gaussian,\n      height ~ 1 + weight_s,\n      prior = c(prior(normal(178, 100), class = Intercept),\n                prior(normal(0, 10), class = b),\n                prior(uniform(0, 50), class = sigma, ub = 50)),\n      iter = 2000, warmup = 1000, chains = 4, cores = 4,\n      backend = \"cmdstanr\", silent = 2,\n      seed = 4,\n      file = \"fits/b04.07\")\n\nf &lt;-\n  fitted(b4.6, \n         newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(weight_seq)\n\np &lt;-\n  predict(b4.6, \n          newdata = weight_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(weight_seq) \n\n\n\nplot Polynomial (Cubic) !Kung height\n\nat &lt;- c(-2, -1, 0, 1, 2)\nggplot(data = kHeight, \n       aes(x = weight_s)) +\n  geom_ribbon(data = p, \n              aes(ymin = Q2.5, ymax = Q97.5),\n              fill = \"grey83\") +\n  geom_smooth(data = f,\n              aes(y = Estimate, ymin = Q2.5, ymax = Q97.5),\n              stat = \"identity\",\n              fill = \"grey70\", color = \"black\", alpha = 1, linewidth = 1/4) +\n  geom_point(aes(y = height),\n             color = \"navyblue\", shape = 1, size = 1.5, alpha = 1/3) +\n  coord_cartesian(xlim = range(kHeight$weight_s)) +\n  theme_minimal()+\n  \n  # here it is!\n  scale_x_continuous(\"standardized weight converted back\",\n                     breaks = at,\n                     labels = round(at * sd(kHeight$weight) + mean(kHeight$weight), 1))"
  },
  {
    "objectID": "ch4_linear_regression.html#splines",
    "href": "ch4_linear_regression.html#splines",
    "title": "ch4",
    "section": "Splines!",
    "text": "Splines!\n\nEDA cherry blossom data\n\nlibrary(rethinking)\n\nrethinking (Version 2.42)\n\n\n\nAttaching package: 'rethinking'\n\n\nThe following objects are masked from 'package:rstan':\n\n    stan, traceplot\n\n\nThe following object is masked from 'package:purrr':\n\n    map\n\n\nThe following objects are masked from 'package:brms':\n\n    LOO, stancode, WAIC\n\n\nThe following object is masked from 'package:stats':\n\n    rstudent\n\ncherry\n\n     year doy temp temp_upper temp_lower\n1     801  NA   NA         NA         NA\n2     802  NA   NA         NA         NA\n3     803  NA   NA         NA         NA\n4     804  NA   NA         NA         NA\n5     805  NA   NA         NA         NA\n6     806  NA   NA         NA         NA\n7     807  NA   NA         NA         NA\n8     808  NA   NA         NA         NA\n9     809  NA   NA         NA         NA\n10    810  NA   NA         NA         NA\n11    811  NA   NA         NA         NA\n12    812  92   NA         NA         NA\n13    813  NA   NA         NA         NA\n14    814  NA   NA         NA         NA\n15    815 105   NA         NA         NA\n16    816  NA   NA         NA         NA\n17    817  NA   NA         NA         NA\n18    818  NA   NA         NA         NA\n19    819  NA   NA         NA         NA\n20    820  NA   NA         NA         NA\n21    821  NA   NA         NA         NA\n22    822  NA   NA         NA         NA\n23    823  NA   NA         NA         NA\n24    824  NA   NA         NA         NA\n25    825  NA   NA         NA         NA\n26    826  NA   NA         NA         NA\n27    827  NA   NA         NA         NA\n28    828  NA   NA         NA         NA\n29    829  NA   NA         NA         NA\n30    830  NA   NA         NA         NA\n31    831  96   NA         NA         NA\n32    832  NA   NA         NA         NA\n33    833  NA   NA         NA         NA\n34    834  NA   NA         NA         NA\n35    835  NA   NA         NA         NA\n36    836  NA   NA         NA         NA\n37    837  NA   NA         NA         NA\n38    838  NA   NA         NA         NA\n39    839  NA 5.87      10.99       0.75\n40    840  NA 5.99      10.78       1.21\n41    841  NA 6.12      10.60       1.64\n42    842  NA 6.25      10.47       2.02\n43    843  NA 6.37      10.39       2.35\n44    844  NA 6.50      10.37       2.63\n45    845  NA 6.62      10.42       2.83\n46    846  NA 6.75      10.54       2.96\n47    847  NA 6.88      10.73       3.03\n48    848  NA 7.00      10.99       3.02\n49    849  NA 7.13      11.31       2.95\n50    850  NA 7.25      11.68       2.83\n51    851 108 7.38      12.10       2.66\n52    852  NA   NA         NA         NA\n53    853 104   NA         NA         NA\n54    854  NA   NA         NA         NA\n55    855  NA   NA         NA         NA\n56    856  NA   NA         NA         NA\n57    857  NA   NA         NA         NA\n58    858  NA   NA         NA         NA\n59    859  NA   NA         NA         NA\n60    860  NA   NA         NA         NA\n61    861  NA 6.63      10.21       3.05\n62    862  NA 6.51       9.40       3.62\n63    863  NA 6.44       9.31       3.56\n64    864 100 6.42       8.69       4.14\n65    865  NA 6.44       8.54       4.34\n66    866 106 6.44       8.11       4.77\n67    867  NA   NA         NA         NA\n68    868  NA   NA         NA         NA\n69    869  95   NA         NA         NA\n70    870  NA   NA         NA         NA\n71    871  NA   NA         NA         NA\n72    872  NA   NA         NA         NA\n73    873  NA   NA         NA         NA\n74    874  NA   NA         NA         NA\n75    875  NA   NA         NA         NA\n76    876  NA 5.60       7.05       4.15\n77    877  NA 5.71       7.00       4.42\n78    878  NA 5.82       7.63       4.01\n79    879  NA 5.95       7.66       4.24\n80    880  NA 6.08       7.73       4.44\n81    881  NA 6.22       7.84       4.59\n82    882  NA 6.40       8.45       4.36\n83    883  NA 6.23       7.57       4.89\n84    884  NA 6.30       7.62       4.97\n85    885  NA 6.36       7.70       5.03\n86    886  NA 6.43       7.79       5.08\n87    887  NA 6.65       8.23       5.08\n88    888  NA 6.74       8.34       5.14\n89    889 104 6.83       8.48       5.19\n90    890  NA 6.88       8.79       4.97\n91    891 109 6.98       8.96       5.00\n92    892 108 7.11       9.11       5.11\n93    893  NA 6.93       8.34       5.53\n94    894 106 6.98       8.40       5.55\n95    895 104 7.08       8.57       5.58\n96    896 104 7.20       8.69       5.72\n97    897  NA 7.35       9.09       5.60\n98    898  NA 7.36       9.05       5.67\n99    899  NA 7.37       9.03       5.70\n100   900  NA 7.45       8.91       5.99\n101   901  NA 7.48       8.92       6.04\n102   902 102 7.50       8.95       6.06\n103   903  NA 7.40       9.01       5.79\n104   904  NA 7.37       8.95       5.80\n105   905  NA 7.34       8.90       5.79\n106   906  NA 7.32       8.88       5.75\n107   907  NA 7.29       8.87       5.70\n108   908  98 7.26       8.89       5.62\n109   909  NA 7.21       9.10       5.31\n110   910  NA 7.19       9.16       5.21\n111   911  NA 6.85       8.85       4.84\n112   912  95 6.78       8.83       4.74\n113   913 110 6.61       8.59       4.63\n114   914  NA 6.92      10.29       3.55\n115   915  NA 6.77      10.21       3.34\n116   916  NA 6.63      10.18       3.07\n117   917  95 6.48      10.21       2.76\n118   918  NA 6.33      10.10       2.56\n119   919  NA 6.40       9.07       3.73\n120   920  NA 6.80       8.52       5.08\n121   921  NA 6.79       8.50       5.07\n122   922  NA 6.77       8.49       5.05\n123   923 104 6.76       8.50       5.01\n124   924  NA 6.84       9.15       4.53\n125   925  NA 7.40       9.95       4.84\n126   926  98 7.45      10.01       4.90\n127   927  NA 6.82       9.60       4.05\n128   928  NA 6.68       9.07       4.29\n129   929  NA 6.78       8.87       4.69\n130   930  97 6.81       8.63       4.98\n131   931  NA 6.47       9.48       3.47\n132   932  NA 6.58       9.43       3.74\n133   933 106 6.72       9.41       4.03\n134   934  NA 6.49      10.03       2.96\n135   935  NA 6.71       9.53       3.90\n136   936  NA 6.83       9.28       4.38\n137   937  NA 6.94       9.02       4.87\n138   938  NA 7.02       8.96       5.08\n139   939  NA 7.10       8.84       5.35\n140   940  NA 7.17       8.82       5.52\n141   941 109 7.25       8.82       5.67\n142   942  NA 7.56       9.11       6.01\n143   943  NA 7.54       9.00       6.08\n144   944  NA 7.47       8.90       6.05\n145   945  NA 7.43       8.73       6.14\n146   946  NA 7.39       8.64       6.14\n147   947  NA 7.23       8.57       5.90\n148   948  NA 7.16       8.48       5.84\n149   949 107 7.10       8.35       5.85\n150   950  95 7.20       8.65       5.75\n151   951  NA 7.08       8.55       5.61\n152   952  NA 6.97       8.45       5.48\n153   953  NA 6.85       8.38       5.33\n154   954  NA 6.74       8.33       5.16\n155   955  89 7.07       8.37       5.77\n156   956  NA 6.94       8.16       5.73\n157   957 112 6.93       8.21       5.66\n158   958 109 6.96       8.34       5.58\n159   959  97 7.14       8.43       5.85\n160   960 101 7.07       8.45       5.69\n161   961  87 7.06       8.44       5.69\n162   962  NA 6.84       7.87       5.81\n163   963  94 6.82       7.88       5.76\n164   964  NA 6.73       7.76       5.69\n165   965 104 6.74       7.83       5.66\n166   966  98 6.76       7.97       5.55\n167   967 103 6.75       8.16       5.34\n168   968  NA 6.79       8.45       5.12\n169   969  98 6.84       8.61       5.07\n170   970  NA 6.48       7.95       5.00\n171   971  NA 6.52       8.05       4.99\n172   972 107 6.57       8.17       4.98\n173   973  NA 6.64       8.38       4.90\n174   974 108 5.91       7.78       4.05\n175   975 101 5.98       8.32       3.64\n176   976  NA 6.20       8.16       4.23\n177   977 112 6.16       7.85       4.48\n178   978  NA 6.57       8.89       4.24\n179   979 104 6.48       8.77       4.20\n180   980  NA 6.74      10.03       3.44\n181   981  NA 6.60       9.81       3.39\n182   982  NA 6.46       9.63       3.29\n183   983  NA 6.32       9.49       3.15\n184   984  NA 6.08       9.39       2.77\n185   985  94 5.92       9.23       2.61\n186   986  NA 5.64       8.16       3.12\n187   987  NA 5.79       7.64       3.95\n188   988  NA 5.67       7.48       3.86\n189   989 100 5.80       7.31       4.28\n190   990  NA 5.53       7.18       3.88\n191   991 104 5.53       7.11       3.94\n192   992  NA 5.29       7.34       3.24\n193   993  NA 5.32       7.24       3.40\n194   994  NA 5.35       7.17       3.53\n195   995  NA 5.38       7.14       3.63\n196   996  NA 5.42       7.14       3.69\n197   997  NA 5.45       7.18       3.71\n198   998  NA 5.48       7.27       3.69\n199   999  NA 5.14       6.80       3.48\n200  1000 105 5.10       6.80       3.41\n201  1001  NA 5.41       7.24       3.57\n202  1002  NA 5.30       6.88       3.72\n203  1003  NA 5.41       6.91       3.92\n204  1004 117 5.62       7.22       4.03\n205  1005  NA 5.89       7.38       4.41\n206  1006 100 5.92       7.27       4.57\n207  1007 106 5.73       7.32       4.14\n208  1008  NA 5.66       7.53       3.79\n209  1009  NA 5.74       7.56       3.92\n210  1010  NA 5.82       7.62       4.03\n211  1011  NA 5.87       7.49       4.24\n212  1012  NA 5.94       7.57       4.32\n213  1013  NA 6.02       7.66       4.38\n214  1014 115 6.09       7.77       4.41\n215  1015  NA 6.26       7.82       4.70\n216  1016 111 6.26       7.64       4.89\n217  1017  99 6.39       7.78       5.01\n218  1018 113 6.04       7.45       4.64\n219  1019  98 6.32       7.93       4.71\n220  1020  NA 6.11       7.62       4.60\n221  1021  NA 6.10       7.55       4.65\n222  1022  NA 6.08       7.49       4.67\n223  1023  NA 6.07       7.47       4.67\n224  1024  NA 6.06       7.47       4.65\n225  1025  NA 6.04       7.49       4.59\n226  1026  NA 6.03       7.54       4.52\n227  1027  NA 6.02       7.61       4.42\n228  1028  NA 6.01       7.70       4.31\n229  1029 116 5.99       7.81       4.18\n230  1030  NA 6.01       7.62       4.40\n231  1031  97 6.63       7.97       5.29\n232  1032 111 6.53       8.01       5.04\n233  1033 102 6.68       8.18       5.19\n234  1034  96 6.67       8.42       4.91\n235  1035  NA 6.45       8.62       4.28\n236  1036 104 6.34       7.98       4.70\n237  1037  NA 6.29       8.37       4.21\n238  1038  NA 6.34       8.40       4.27\n239  1039  NA 6.38       8.46       4.31\n240  1040  NA 6.43       8.54       4.31\n241  1041 103 6.01       7.82       4.21\n242  1042  NA 5.95       8.12       3.78\n243  1043  NA 6.02       7.81       4.24\n244  1044  NA 6.02       7.79       4.26\n245  1045  NA 6.03       7.80       4.26\n246  1046 103 6.03       7.82       4.24\n247  1047  NA 5.96       8.15       3.77\n248  1048 112 5.98       8.20       3.75\n249  1049  NA 6.22       8.97       3.48\n250  1050 105 6.36       8.38       4.34\n251  1051  NA 6.53       9.42       3.63\n252  1052  NA 6.48       9.27       3.69\n253  1053  NA 6.65       8.97       4.32\n254  1054  NA 6.35       9.09       3.60\n255  1055  NA 6.28       8.94       3.62\n256  1056  NA 6.21       8.81       3.61\n257  1057  NA 6.14       8.72       3.56\n258  1058  NA 6.19       8.32       4.07\n259  1059  NA 6.14       8.26       4.03\n260  1060 108 6.15       7.97       4.34\n261  1061  92 6.33       8.59       4.07\n262  1062  NA 5.73       7.72       3.75\n263  1063  NA 5.75       7.44       4.06\n264  1064  NA 5.77       7.41       4.12\n265  1065  NA 5.87       7.43       4.32\n266  1066 105 6.04       7.69       4.39\n267  1067  NA 5.93       7.95       3.91\n268  1068  NA 6.02       7.89       4.15\n269  1069  NA 6.07       7.72       4.43\n270  1070  NA 6.15       7.74       4.56\n271  1071 113 6.23       7.79       4.68\n272  1072  NA 6.45       7.72       5.19\n273  1073 103 6.49       7.72       5.26\n274  1074  NA 6.37       7.69       5.04\n275  1075  NA 6.31       7.63       4.98\n276  1076  NA 6.28       7.55       5.01\n277  1077  NA 6.26       7.41       5.11\n278  1078  NA 6.24       7.35       5.12\n279  1079  NA 6.21       7.31       5.11\n280  1080 102 6.19       7.29       5.09\n281  1081  NA 6.02       7.23       4.80\n282  1082  NA 6.03       7.13       4.93\n283  1083  96 5.99       7.09       4.90\n284  1084 120 5.90       6.91       4.89\n285  1085  NA 6.25       7.19       5.31\n286  1086  NA 6.20       7.13       5.27\n287  1087  NA 6.12       7.05       5.18\n288  1088 104 6.16       6.98       5.35\n289  1089  NA 6.16       7.04       5.27\n290  1090 105 6.16       6.97       5.36\n291  1091  NA 6.18       7.07       5.29\n292  1092  NA 6.13       7.03       5.24\n293  1093 105 5.99       6.96       5.02\n294  1094  NA 6.17       7.08       5.26\n295  1095 100 6.06       7.00       5.12\n296  1096  96 5.97       6.87       5.06\n297  1097  NA 5.77       6.52       5.03\n298  1098 100 5.70       6.45       4.96\n299  1099 103 5.59       6.27       4.91\n300  1100  NA 5.54       6.23       4.85\n301  1101  NA 5.58       6.24       4.92\n302  1102 104 5.60       6.24       4.95\n303  1103  NA 5.54       6.25       4.83\n304  1104 108 5.56       6.22       4.90\n305  1105 114 5.58       6.28       4.88\n306  1106  NA 5.74       6.39       5.09\n307  1107 105 5.74       6.38       5.09\n308  1108  NA 5.72       6.41       5.03\n309  1109  NA 5.61       6.32       4.89\n310  1110  NA 5.66       6.32       5.00\n311  1111 113 5.58       6.24       4.92\n312  1112 104 5.67       6.41       4.93\n313  1113  NA 5.61       6.37       4.85\n314  1114 100 5.56       6.32       4.79\n315  1115  NA 5.48       6.13       4.83\n316  1116  NA 5.45       6.10       4.80\n317  1117 109 5.42       6.09       4.75\n318  1118 102 5.42       6.17       4.67\n319  1119  NA 5.35       6.08       4.62\n320  1120 104 5.32       6.08       4.55\n321  1121  NA 5.28       5.98       4.57\n322  1122  NA 5.25       5.99       4.52\n323  1123 112 5.23       6.00       4.46\n324  1124  98 5.67       6.49       4.85\n325  1125 111 5.61       6.48       4.74\n326  1126 108 6.11       7.49       4.73\n327  1127 107 6.18       7.67       4.69\n328  1128 111 6.25       7.89       4.61\n329  1129 106 6.26       7.69       4.82\n330  1130 103 6.30       7.89       4.71\n331  1131 103 5.97       7.45       4.49\n332  1132  NA 5.87       7.64       4.10\n333  1133  NA 5.73       7.19       4.27\n334  1134 106 5.84       7.26       4.42\n335  1135  NA 5.77       7.21       4.32\n336  1136  NA 5.93       7.47       4.40\n337  1137  NA 5.87       7.21       4.53\n338  1138  NA 5.92       7.24       4.61\n339  1139 113 5.83       7.02       4.65\n340  1140 103 5.89       7.05       4.72\n341  1141 111 5.82       7.08       4.56\n342  1142  NA 6.04       7.34       4.74\n343  1143 110 5.92       7.27       4.57\n344  1144  NA 6.14       7.76       4.52\n345  1145 107 6.02       7.59       4.45\n346  1146  NA 6.27       8.20       4.34\n347  1147  NA 6.11       7.93       4.29\n348  1148  NA 5.95       7.68       4.22\n349  1149  NA 5.88       7.36       4.40\n350  1150  NA 5.88       7.15       4.61\n351  1151 109 5.80       7.04       4.56\n352  1152  NA 5.95       7.23       4.66\n353  1153  NA 5.95       7.10       4.81\n354  1154  96 5.82       7.00       4.65\n355  1155  NA 5.59       6.73       4.45\n356  1156  90 5.52       6.64       4.39\n357  1157  NA 5.29       6.14       4.43\n358  1158  NA 5.29       6.09       4.48\n359  1159 103 5.28       6.08       4.48\n360  1160  NA 5.17       5.97       4.37\n361  1161 112 5.19       5.95       4.43\n362  1162  NA 5.24       6.03       4.44\n363  1163 112 5.23       6.03       4.42\n364  1164 100 5.10       6.01       4.19\n365  1165 106 5.00       5.89       4.11\n366  1166  95 4.96       5.90       4.02\n367  1167 111 4.83       5.69       3.98\n368  1168  NA 4.85       5.77       3.94\n369  1169 112 4.86       5.71       4.00\n370  1170 113 4.98       5.84       4.13\n371  1171  NA 5.26       6.24       4.28\n372  1172 103 5.28       6.22       4.35\n373  1173 117 5.24       6.22       4.27\n374  1174 112 5.30       6.15       4.46\n375  1175 113 5.39       6.21       4.56\n376  1176 113 5.48       6.31       4.64\n377  1177  NA 5.61       6.42       4.80\n378  1178  NA 5.61       6.42       4.80\n379  1179 103 5.61       6.43       4.80\n380  1180  98 5.48       6.30       4.66\n381  1181  NA 5.36       6.19       4.52\n382  1182 104 5.52       6.42       4.61\n383  1183 101 5.44       6.36       4.53\n384  1184 115 5.38       6.43       4.33\n385  1185 115 5.46       6.36       4.56\n386  1186  NA 5.65       6.49       4.81\n387  1187 104 5.70       6.53       4.87\n388  1188 107 5.66       6.59       4.73\n389  1189  NA 5.70       6.71       4.68\n390  1190 112 5.69       6.58       4.79\n391  1191 106 5.84       6.74       4.93\n392  1192  NA 5.83       6.82       4.85\n393  1193  NA 5.76       6.63       4.88\n394  1194 119 5.79       6.65       4.93\n395  1195  NA 6.01       6.72       5.30\n396  1196  NA 6.00       6.67       5.32\n397  1197  NA 5.92       6.60       5.24\n398  1198  NA 5.89       6.57       5.21\n399  1199 109 6.01       6.67       5.35\n400  1200 104 6.10       6.76       5.45\n401  1201  96 6.15       6.81       5.48\n402  1202 106 6.18       7.01       5.36\n403  1203 105 6.18       6.98       5.37\n404  1204 110 6.20       7.05       5.34\n405  1205 105 6.20       6.98       5.42\n406  1206  NA 6.38       7.45       5.32\n407  1207 104 6.45       7.50       5.40\n408  1208  NA 6.47       7.60       5.35\n409  1209  NA 6.55       7.68       5.43\n410  1210 112 6.51       7.53       5.49\n411  1211  NA 6.63       7.62       5.63\n412  1212  98 6.67       7.69       5.65\n413  1213 107 6.66       7.80       5.53\n414  1214 102 6.55       7.58       5.51\n415  1215 108 6.42       7.44       5.41\n416  1216 101 6.56       7.58       5.54\n417  1217  NA 6.47       7.49       5.46\n418  1218  NA 6.49       7.51       5.47\n419  1219 101 6.41       7.38       5.45\n420  1220 109 6.19       7.23       5.15\n421  1221  99 6.33       7.36       5.29\n422  1222  NA 6.25       7.32       5.18\n423  1223 116 6.24       7.32       5.16\n424  1224  NA 6.30       7.43       5.18\n425  1225 105 6.25       7.38       5.11\n426  1226 106 6.23       7.47       4.99\n427  1227 111 6.51       7.70       5.32\n428  1228  NA 6.60       7.92       5.27\n429  1229  97 6.74       7.92       5.56\n430  1230 102 6.66       7.88       5.44\n431  1231 101 6.64       7.96       5.32\n432  1232  92 6.76       8.05       5.47\n433  1233 105 6.27       7.64       4.91\n434  1234  NA 6.33       7.70       4.95\n435  1235 110 6.41       7.69       5.12\n436  1236  87 6.55       7.92       5.17\n437  1237  NA 6.09       7.31       4.87\n438  1238  NA 6.12       7.26       4.99\n439  1239  NA 6.19       7.28       5.10\n440  1240 106 6.24       7.32       5.16\n441  1241  NA 6.29       7.40       5.18\n442  1242  NA 6.35       7.44       5.25\n443  1243  NA 6.40       7.50       5.30\n444  1244 108 6.46       7.57       5.34\n445  1245 108 6.40       7.44       5.37\n446  1246  98 6.47       7.54       5.39\n447  1247 106 6.40       7.59       5.22\n448  1248  NA 6.23       7.39       5.06\n449  1249 108 6.29       7.38       5.19\n450  1250 116 6.38       7.46       5.30\n451  1251 100 6.61       7.71       5.51\n452  1252  NA 6.56       7.72       5.39\n453  1253  NA 6.55       7.62       5.49\n454  1254 110 6.57       7.56       5.59\n455  1255  NA 6.71       7.75       5.66\n456  1256  NA 6.57       7.67       5.47\n457  1257  94 6.46       7.57       5.35\n458  1258  NA 6.27       7.25       5.29\n459  1259  96 6.21       7.15       5.28\n460  1260  NA 6.06       6.93       5.20\n461  1261  NA 6.02       6.88       5.16\n462  1262  97 5.98       6.80       5.16\n463  1263 120 5.86       6.63       5.08\n464  1264 103 6.15       6.88       5.42\n465  1265  98 6.19       6.87       5.51\n466  1266  NA 6.07       6.70       5.45\n467  1267 105 6.05       6.67       5.42\n468  1268 103 6.04       6.72       5.37\n469  1269 100 6.01       6.72       5.30\n470  1270  NA 5.93       6.62       5.23\n471  1271 100 6.14       6.97       5.32\n472  1272  NA 6.15       7.29       5.02\n473  1273  NA 6.26       7.40       5.12\n474  1274  NA 6.36       7.52       5.20\n475  1275 107 6.47       7.67       5.27\n476  1276  NA 6.56       7.86       5.27\n477  1277  NA 6.46       7.55       5.37\n478  1278 113 6.54       7.67       5.40\n479  1279 101 6.65       7.67       5.62\n480  1280 102 6.69       7.90       5.47\n481  1281  NA 6.88       8.45       5.30\n482  1282  NA 6.86       8.27       5.45\n483  1283 103 6.96       8.41       5.51\n484  1284 102 6.87       8.29       5.46\n485  1285 105 6.56       7.80       5.31\n486  1286 112 6.52       7.72       5.31\n487  1287 110 6.65       7.67       5.63\n488  1288 108 6.80       7.75       5.86\n489  1289 107 6.72       7.83       5.61\n490  1290  NA 6.89       8.19       5.59\n491  1291  NA 6.88       8.04       5.72\n492  1292 107 6.81       7.92       5.71\n493  1293  NA 6.83       8.71       4.96\n494  1294 101 6.82       8.43       5.21\n495  1295 102 6.87       8.66       5.07\n496  1296  NA 7.06       9.14       4.98\n497  1297  NA 6.90       8.87       4.93\n498  1298  NA 6.74       8.62       4.86\n499  1299  NA 6.58       8.42       4.73\n500  1300  NA 6.46       8.16       4.76\n501  1301  95 6.31       7.98       4.65\n502  1302  96 6.11       7.77       4.45\n503  1303  NA 5.93       7.52       4.34\n504  1304  NA 5.79       7.32       4.25\n505  1305  NA 5.64       7.15       4.13\n506  1306  NA 5.50       7.01       3.99\n507  1307 104 5.35       6.89       3.82\n508  1308  NA 5.24       6.93       3.55\n509  1309  NA 5.07       6.84       3.31\n510  1310  NA 4.90       6.77       3.04\n511  1311  94 4.73       6.73       2.74\n512  1312 100 4.88       6.30       3.45\n513  1313  NA 4.77       6.18       3.36\n514  1314 101 5.10       6.26       3.94\n515  1315 111 5.03       6.22       3.84\n516  1316 103 5.11       6.23       3.98\n517  1317 102 5.03       6.09       3.96\n518  1318  NA 4.93       6.08       3.79\n519  1319 116 4.85       5.88       3.82\n520  1320  NA 5.12       6.16       4.08\n521  1321 102 4.99       5.98       4.01\n522  1322 106 4.88       5.91       3.84\n523  1323 124 4.82       5.96       3.68\n524  1324  98 5.09       6.06       4.12\n525  1325  NA 4.87       5.77       3.96\n526  1326 107 4.69       5.56       3.83\n527  1327  NA 4.67       5.56       3.79\n528  1328  NA 4.67       5.47       3.86\n529  1329 112 4.74       5.53       3.95\n530  1330 108 4.89       5.82       3.97\n531  1331 112 4.82       5.82       3.82\n532  1332 115 4.87       5.94       3.79\n533  1333  NA 5.16       6.20       4.12\n534  1334  NA 5.17       6.09       4.24\n535  1335  NA 5.16       6.03       4.30\n536  1336  NA 5.15       5.96       4.34\n537  1337  NA 5.20       6.08       4.32\n538  1338  NA 5.36       6.64       4.09\n539  1339  NA 5.52       6.90       4.14\n540  1340  NA 5.56       6.79       4.32\n541  1341  NA 5.64       6.85       4.44\n542  1342 110 5.72       6.88       4.57\n543  1343  NA 5.71       6.80       4.63\n544  1344 102 5.78       6.85       4.71\n545  1345  NA 5.71       6.86       4.57\n546  1346 107 5.82       6.97       4.68\n547  1347 109 5.81       6.95       4.68\n548  1348  NA 5.85       6.96       4.73\n549  1349 112 5.91       6.97       4.85\n550  1350 101 6.02       7.03       5.00\n551  1351 115 5.89       6.93       4.84\n552  1352  NA 6.04       6.96       5.12\n553  1353  NA 6.09       6.97       5.22\n554  1354  NA 6.18       7.05       5.31\n555  1355  NA 6.26       7.12       5.40\n556  1356 117 6.28       7.09       5.48\n557  1357 107 6.46       7.16       5.76\n558  1358 110 6.54       7.24       5.84\n559  1359 105 6.63       7.31       5.95\n560  1360 101 6.67       7.37       5.97\n561  1361 108 6.66       7.41       5.92\n562  1362  NA 6.73       7.48       5.98\n563  1363 107 6.76       7.53       5.99\n564  1364 110 6.80       7.60       6.01\n565  1365  NA 6.84       7.66       6.03\n566  1366 112 6.83       7.69       5.97\n567  1367  97 6.80       7.73       5.86\n568  1368  88 6.71       7.59       5.83\n569  1369  94 6.66       7.32       5.99\n570  1370 109 6.68       7.36       6.00\n571  1371  NA 6.72       7.28       6.16\n572  1372 102 6.69       7.20       6.18\n573  1373 110 6.64       7.13       6.15\n574  1374  NA 6.70       7.13       6.27\n575  1375 103 6.70       7.15       6.25\n576  1376  99 6.72       7.16       6.29\n577  1377 105 6.73       7.15       6.31\n578  1378 104 6.57       7.09       6.06\n579  1379 103 6.94       7.77       6.11\n580  1380 102 6.94       7.76       6.12\n581  1381 108 6.95       7.82       6.07\n582  1382 105 7.18       8.11       6.26\n583  1383 102 7.40       8.43       6.37\n584  1384  98 7.43       8.53       6.33\n585  1385  99 7.27       8.38       6.17\n586  1386 105 7.19       8.34       6.03\n587  1387 100 7.21       8.37       6.05\n588  1388  99 7.18       8.44       5.91\n589  1389  NA 6.98       8.47       5.49\n590  1390  NA 7.07       8.44       5.70\n591  1391  NA 7.07       8.30       5.83\n592  1392  NA 7.07       8.23       5.91\n593  1393  NA 7.07       8.14       6.00\n594  1394  NA 7.06       8.05       6.08\n595  1395  NA 7.08       7.99       6.16\n596  1396  NA 7.10       7.95       6.24\n597  1397  NA 7.10       7.90       6.29\n598  1398 106 7.10       7.89       6.32\n599  1399  NA 7.21       7.99       6.43\n600  1400  NA 7.15       7.91       6.38\n601  1401 101 7.13       7.86       6.40\n602  1402 103 7.10       7.84       6.36\n603  1403 104 7.16       7.90       6.42\n604  1404  NA 7.11       7.96       6.26\n605  1405  NA 7.14       7.93       6.35\n606  1406 102 7.13       7.88       6.37\n607  1407 101 7.12       7.88       6.36\n608  1408 111 7.14       7.90       6.38\n609  1409  86 7.26       8.03       6.49\n610  1410 102 7.10       7.71       6.49\n611  1411  NA 7.08       7.70       6.45\n612  1412  93 7.05       7.68       6.43\n613  1413  91 6.91       7.50       6.31\n614  1414  NA 6.72       7.26       6.17\n615  1415 105 6.71       7.26       6.17\n616  1416 101 6.67       7.24       6.10\n617  1417 109 6.56       7.18       5.94\n618  1418  98 6.70       7.32       6.08\n619  1419 100 6.75       7.35       6.15\n620  1420 112 6.75       7.35       6.15\n621  1421  99 6.84       7.41       6.26\n622  1422 109 6.92       7.53       6.31\n623  1423  96 6.94       7.54       6.33\n624  1424 103 6.84       7.43       6.25\n625  1425  98 6.91       7.51       6.31\n626  1426  99 6.83       7.43       6.23\n627  1427 102 6.77       7.37       6.17\n628  1428  NA 6.68       7.32       6.04\n629  1429  98 6.57       7.25       5.90\n630  1430 108 6.45       7.14       5.76\n631  1431 102 6.47       7.19       5.75\n632  1432 104 6.43       7.16       5.71\n633  1433  98 6.47       7.18       5.75\n634  1434 113 6.41       7.09       5.72\n635  1435  95 6.56       7.24       5.87\n636  1436 101 6.46       7.09       5.82\n637  1437 103 6.45       7.07       5.83\n638  1438  99 6.47       7.08       5.86\n639  1439 101 6.42       7.04       5.80\n640  1440  98 6.38       7.02       5.74\n641  1441 105 6.33       6.99       5.67\n642  1442  NA 6.22       6.92       5.52\n643  1443 107 6.20       6.91       5.49\n644  1444 109 6.32       7.03       5.60\n645  1445  NA 6.34       7.10       5.59\n646  1446 108 6.40       7.12       5.68\n647  1447 111 6.34       7.09       5.58\n648  1448  96 6.23       7.12       5.35\n649  1449  95 6.10       6.97       5.24\n650  1450 100 6.04       6.81       5.28\n651  1451 103 5.99       6.73       5.26\n652  1452  92 5.95       6.69       5.21\n653  1453 107 5.88       6.48       5.27\n654  1454 105 5.99       6.63       5.36\n655  1455  96 6.13       6.84       5.42\n656  1456 106 6.09       6.85       5.33\n657  1457 105 6.23       7.11       5.35\n658  1458 112 6.24       7.12       5.36\n659  1459 113 6.36       7.19       5.52\n660  1460 111 6.52       7.32       5.72\n661  1461 106 6.57       7.29       5.85\n662  1462 106 6.56       7.25       5.86\n663  1463 101 6.62       7.31       5.93\n664  1464 104 6.56       7.26       5.86\n665  1465  98 6.64       7.41       5.88\n666  1466 105 6.60       7.43       5.77\n667  1467 101 6.59       7.39       5.79\n668  1468 101 6.58       7.44       5.71\n669  1469  NA 6.47       7.34       5.60\n670  1470  NA 6.55       7.41       5.69\n671  1471  NA 6.59       7.39       5.79\n672  1472 114 6.53       7.28       5.77\n673  1473  NA 6.62       7.32       5.91\n674  1474  98 6.52       7.24       5.80\n675  1475  NA 6.44       7.15       5.73\n676  1476 100 6.41       7.10       5.72\n677  1477 110 6.34       7.03       5.65\n678  1478 115 6.33       7.06       5.60\n679  1479 110 6.45       7.19       5.71\n680  1480 104 6.45       7.26       5.63\n681  1481 106 6.38       7.26       5.51\n682  1482 108 6.36       7.29       5.42\n683  1483 101 6.34       7.36       5.32\n684  1484  97 6.30       7.30       5.30\n685  1485  94 6.17       7.17       5.18\n686  1486  99 6.07       6.96       5.19\n687  1487  93 6.01       6.85       5.17\n688  1488 103 5.80       6.60       5.00\n689  1489 100 5.73       6.55       4.91\n690  1490  97 5.68       6.45       4.92\n691  1491 107 5.59       6.28       4.90\n692  1492 108 5.63       6.31       4.95\n693  1493 100 5.62       6.32       4.92\n694  1494 106 5.54       6.21       4.87\n695  1495  94 5.56       6.21       4.91\n696  1496  97 5.38       5.95       4.81\n697  1497 108 5.31       5.80       4.82\n698  1498  97 5.32       5.81       4.83\n699  1499 111 5.23       5.66       4.80\n700  1500  97 5.26       5.69       4.84\n701  1501 103 5.21       5.62       4.80\n702  1502 115 5.16       5.58       4.75\n703  1503 108 5.20       5.56       4.84\n704  1504 114 5.20       5.56       4.84\n705  1505 106 5.37       5.81       4.93\n706  1506 106 5.36       5.80       4.92\n707  1507 108 5.34       5.79       4.90\n708  1508 111 5.31       5.74       4.87\n709  1509 102 5.23       5.70       4.76\n710  1510 110 5.06       5.58       4.53\n711  1511 111 5.07       5.60       4.54\n712  1512 109 5.15       5.69       4.62\n713  1513 110 5.06       5.66       4.47\n714  1514 105 5.09       5.69       4.49\n715  1515 111 5.16       5.77       4.56\n716  1516 104 5.16       5.77       4.54\n717  1517 106 5.16       5.76       4.56\n718  1518 115 5.05       5.69       4.42\n719  1519 111 5.04       5.73       4.35\n720  1520 105 5.04       5.75       4.33\n721  1521 107 5.00       5.70       4.31\n722  1522 103 5.03       5.71       4.35\n723  1523 109 4.89       5.60       4.18\n724  1524 109 4.86       5.61       4.12\n725  1525 104 4.95       5.68       4.22\n726  1526 113 4.80       5.57       4.04\n727  1527 105 5.01       5.81       4.21\n728  1528 106 4.95       5.75       4.16\n729  1529 107 5.06       5.89       4.23\n730  1530 107 5.13       5.99       4.28\n731  1531 103 5.18       6.07       4.30\n732  1532 108 5.23       6.17       4.28\n733  1533 111 5.31       6.31       4.31\n734  1534 108 5.33       6.30       4.35\n735  1535  95 5.26       6.22       4.31\n736  1536 108 5.25       6.31       4.18\n737  1537 108 5.24       6.31       4.18\n738  1538 112 5.26       6.33       4.18\n739  1539 120 5.35       6.45       4.24\n740  1540 122 5.40       6.38       4.42\n741  1541 109 5.51       6.38       4.64\n742  1542 102 5.52       6.38       4.66\n743  1543 119 5.50       6.42       4.59\n744  1544 107 5.70       6.58       4.82\n745  1545  97 5.74       6.66       4.81\n746  1546 112 5.61       6.54       4.68\n747  1547 104 5.73       6.67       4.79\n748  1548 118 5.75       6.76       4.74\n749  1549 117 5.89       6.81       4.96\n750  1550 111 6.08       6.98       5.19\n751  1551 109 6.13       6.98       5.28\n752  1552 104 6.19       7.06       5.32\n753  1553 119 6.13       6.99       5.27\n754  1554  NA 6.24       7.01       5.47\n755  1555 101 6.23       6.97       5.48\n756  1556 120 6.17       6.91       5.44\n757  1557  93 6.31       7.00       5.62\n758  1558 111 6.17       6.77       5.58\n759  1559  96 6.24       6.84       5.64\n760  1560 100 6.18       6.71       5.65\n761  1561 102 6.25       6.84       5.66\n762  1562  99 6.29       6.92       5.65\n763  1563  99 6.13       6.78       5.49\n764  1564 109 6.18       6.96       5.39\n765  1565 114 6.16       6.89       5.43\n766  1566  97 6.28       6.94       5.63\n767  1567 108 6.09       6.76       5.42\n768  1568 106 6.09       6.76       5.43\n769  1569  NA 6.13       6.80       5.46\n770  1570 112 6.16       6.80       5.51\n771  1571 108 6.35       7.04       5.67\n772  1572 107 6.38       7.06       5.71\n773  1573  NA 6.47       7.15       5.79\n774  1574  98 6.54       7.22       5.86\n775  1575  NA 6.45       7.13       5.77\n776  1576 109 6.44       7.09       5.80\n777  1577 100 6.45       7.10       5.81\n778  1578  NA 6.41       7.07       5.75\n779  1579 102 6.37       7.01       5.72\n780  1580  97 6.29       6.95       5.63\n781  1581 105 6.22       6.88       5.55\n782  1582  NA 6.43       7.23       5.63\n783  1583 108 6.41       7.18       5.65\n784  1584 106 6.45       7.20       5.70\n785  1585 105 6.40       7.15       5.65\n786  1586 106 6.23       7.08       5.37\n787  1587 105 6.21       7.08       5.35\n788  1588 106 6.25       7.11       5.39\n789  1589 105 6.39       7.26       5.52\n790  1590 102 6.39       7.31       5.48\n791  1591  94 6.32       7.24       5.39\n792  1592  98 6.20       7.08       5.32\n793  1593 113 6.05       6.94       5.16\n794  1594  93 6.05       6.98       5.13\n795  1595 111 6.05       6.91       5.19\n796  1596 104 6.16       7.02       5.30\n797  1597 114 6.15       7.04       5.26\n798  1598 110 6.25       7.13       5.37\n799  1599 103 6.22       7.15       5.29\n800  1600 101 6.18       7.16       5.21\n801  1601  93 6.12       7.13       5.11\n802  1602 107 6.03       6.94       5.12\n803  1603  99 6.15       7.06       5.24\n804  1604  95 6.21       7.14       5.27\n805  1605 105 6.19       7.18       5.20\n806  1606 106 6.22       7.26       5.18\n807  1607 110 6.21       7.24       5.19\n808  1608  NA 6.25       7.23       5.28\n809  1609 108 6.22       7.14       5.30\n810  1610 110 6.27       7.18       5.36\n811  1611  NA 6.19       7.13       5.25\n812  1612  87 6.07       7.02       5.12\n813  1613 106 5.78       6.60       4.95\n814  1614 103 5.79       6.62       4.96\n815  1615 110 5.83       6.67       4.99\n816  1616 122 6.08       7.06       5.10\n817  1617 107 6.20       7.09       5.31\n818  1618 102 6.23       7.16       5.30\n819  1619  93 6.21       7.13       5.29\n820  1620  NA 6.08       6.97       5.20\n821  1621 109 6.07       6.91       5.22\n822  1622 106 6.09       6.92       5.26\n823  1623 113 6.04       6.89       5.18\n824  1624 112 6.15       7.01       5.29\n825  1625  95 6.26       7.14       5.39\n826  1626 100 6.15       6.95       5.35\n827  1627  NA 6.08       6.90       5.27\n828  1628 104 6.04       6.83       5.26\n829  1629 112 6.03       6.84       5.21\n830  1630  NA 6.05       6.92       5.18\n831  1631  NA 6.17       7.00       5.34\n832  1632 104 6.10       6.92       5.28\n833  1633  98 6.09       6.91       5.27\n834  1634  96 6.02       6.81       5.24\n835  1635  97 5.86       6.63       5.09\n836  1636  NA 5.74       6.49       5.00\n837  1637 105 5.68       6.41       4.96\n838  1638 105 5.63       6.37       4.90\n839  1639 108 5.65       6.38       4.92\n840  1640 103 5.71       6.44       4.97\n841  1641 117 5.58       6.34       4.82\n842  1642 114 5.64       6.42       4.86\n843  1643 114 5.74       6.53       4.95\n844  1644 105 5.75       6.65       4.85\n845  1645  99 5.70       6.63       4.76\n846  1646  87 5.66       6.51       4.81\n847  1647 112 5.51       6.12       4.91\n848  1648  NA 5.55       6.17       4.94\n849  1649 104 5.48       6.11       4.85\n850  1650 102 5.43       6.05       4.81\n851  1651 107 5.35       5.96       4.74\n852  1652 107 5.38       5.98       4.78\n853  1653 112 5.37       5.98       4.77\n854  1654 104 5.34       6.03       4.65\n855  1655 104 5.32       5.98       4.66\n856  1656 103 5.31       5.94       4.67\n857  1657  NA 5.28       5.90       4.67\n858  1658 108 5.22       5.83       4.61\n859  1659  NA 5.32       5.95       4.68\n860  1660 111 5.45       6.14       4.76\n861  1661  93 5.53       6.22       4.84\n862  1662 110 5.38       6.05       4.71\n863  1663 105 5.40       6.06       4.75\n864  1664 105 5.37       6.03       4.71\n865  1665 112 5.24       5.91       4.57\n866  1666 108 5.22       5.88       4.56\n867  1667 112 5.19       5.85       4.53\n868  1668 110 5.29       5.96       4.62\n869  1669 104 5.41       6.12       4.70\n870  1670 102 5.30       6.02       4.59\n871  1671 116 5.21       5.92       4.50\n872  1672 112 5.21       5.92       4.50\n873  1673 105 5.29       6.00       4.58\n874  1674 115 5.22       5.94       4.50\n875  1675 111 5.28       6.00       4.55\n876  1676 103 5.24       6.01       4.47\n877  1677  96 5.17       5.93       4.41\n878  1678 109 5.10       5.78       4.42\n879  1679 114 5.13       5.81       4.45\n880  1680 109 5.17       5.88       4.46\n881  1681 110 5.16       5.90       4.42\n882  1682 104 5.16       5.94       4.37\n883  1683 108 5.19       5.95       4.43\n884  1684 118 5.19       5.95       4.43\n885  1685 106 5.27       6.03       4.52\n886  1686 104 5.24       5.99       4.48\n887  1687 104 5.33       6.07       4.58\n888  1688 114 5.37       6.11       4.62\n889  1689  97 5.49       6.23       4.75\n890  1690  93 5.32       6.04       4.59\n891  1691 103 5.32       6.12       4.52\n892  1692 109 5.35       6.24       4.46\n893  1693 107 5.39       6.29       4.49\n894  1694 109 5.47       6.45       4.49\n895  1695 120 5.49       6.45       4.52\n896  1696 114 5.51       6.32       4.71\n897  1697 111 5.53       6.27       4.79\n898  1698 101 5.60       6.32       4.87\n899  1699  97 5.55       6.30       4.80\n900  1700 116 5.47       6.29       4.65\n901  1701 112 5.58       6.33       4.82\n902  1702 116 5.61       6.32       4.91\n903  1703 103 5.70       6.33       5.08\n904  1704 113 5.70       6.36       5.04\n905  1705 109 5.82       6.47       5.18\n906  1706 115 5.86       6.47       5.24\n907  1707 111 6.08       6.74       5.43\n908  1708 103 6.19       6.82       5.56\n909  1709 106 6.12       6.76       5.49\n910  1710  NA 6.06       6.73       5.40\n911  1711  NA 6.03       6.67       5.38\n912  1712  NA 5.98       6.61       5.35\n913  1713 104 5.95       6.56       5.33\n914  1714 108 6.01       6.62       5.39\n915  1715 107 6.03       6.65       5.42\n916  1716 110 6.01       6.65       5.37\n917  1717  98 6.10       6.73       5.46\n918  1718 102 6.11       6.74       5.49\n919  1719 102 6.13       6.76       5.49\n920  1720 114 6.05       6.69       5.41\n921  1721  95 6.16       6.77       5.55\n922  1722 100 6.01       6.60       5.43\n923  1723 104 6.05       6.68       5.42\n924  1724  99 5.95       6.59       5.30\n925  1725 106 5.76       6.44       5.08\n926  1726 116 5.74       6.42       5.05\n927  1727 112 5.78       6.48       5.09\n928  1728 104 5.89       6.59       5.19\n929  1729 105 5.85       6.55       5.14\n930  1730  NA 5.86       6.56       5.17\n931  1731 104 6.01       6.73       5.28\n932  1732 108 5.99       6.71       5.26\n933  1733 107 5.95       6.69       5.21\n934  1734 102 6.04       6.78       5.29\n935  1735 101 6.00       6.74       5.25\n936  1736 106 5.89       6.64       5.13\n937  1737  93 5.94       6.69       5.18\n938  1738 101 5.71       6.46       4.97\n939  1739 110 5.67       6.41       4.94\n940  1740 115 5.72       6.45       4.99\n941  1741 109 5.82       6.53       5.11\n942  1742 109 5.85       6.56       5.13\n943  1743 108 5.93       6.64       5.21\n944  1744  98 5.91       6.64       5.18\n945  1745 105 5.90       6.61       5.18\n946  1746 110 5.87       6.59       5.16\n947  1747 101 5.93       6.64       5.21\n948  1748  96 5.83       6.55       5.12\n949  1749 100 5.83       6.56       5.10\n950  1750 110 5.75       6.48       5.02\n951  1751 103 5.93       6.75       5.12\n952  1752 110 5.88       6.69       5.07\n953  1753  96 5.94       6.74       5.14\n954  1754 115 5.86       6.68       5.04\n955  1755 120 5.92       6.67       5.17\n956  1756 109 6.04       6.71       5.38\n957  1757 112 6.08       6.74       5.42\n958  1758 101 6.10       6.76       5.45\n959  1759 109 6.05       6.70       5.41\n960  1760 103 5.97       6.70       5.24\n961  1761  89 6.00       6.72       5.29\n962  1762 106 5.89       6.51       5.26\n963  1763 112 5.89       6.51       5.26\n964  1764  98 5.96       6.57       5.35\n965  1765 106 5.82       6.43       5.21\n966  1766 113 5.85       6.46       5.24\n967  1767 101 6.00       6.61       5.38\n968  1768 117 5.91       6.53       5.29\n969  1769 105 6.04       6.62       5.46\n970  1770 105 6.06       6.64       5.48\n971  1771 104 6.06       6.64       5.48\n972  1772 106 6.13       6.74       5.53\n973  1773 100 6.10       6.71       5.49\n974  1774 110 6.06       6.67       5.46\n975  1775  99 6.22       6.87       5.57\n976  1776 108 6.09       6.75       5.43\n977  1777 104 6.02       6.71       5.32\n978  1778 111 6.07       6.77       5.37\n979  1779  96 6.11       6.80       5.41\n980  1780 109 6.07       6.74       5.39\n981  1781  91 6.06       6.74       5.38\n982  1782 109 5.79       6.46       5.13\n983  1783 103 5.81       6.48       5.14\n984  1784 105 5.72       6.41       5.03\n985  1785 108 5.66       6.37       4.96\n986  1786 106 5.71       6.41       5.01\n987  1787 105 5.67       6.39       4.96\n988  1788 109 5.66       6.37       4.95\n989  1789 106 5.69       6.41       4.98\n990  1790 119 5.79       6.52       5.07\n991  1791  99 5.88       6.60       5.16\n992  1792 101 5.85       6.54       5.17\n993  1793 106 5.81       6.48       5.13\n994  1794 104 5.79       6.47       5.11\n995  1795 113 5.70       6.41       4.99\n996  1796 103 5.74       6.47       5.00\n997  1797  97 5.76       6.47       5.05\n998  1798 110 5.62       6.30       4.93\n999  1799 103 5.60       6.32       4.88\n1000 1800 103 5.58       6.28       4.88\n1001 1801 105 5.48       6.20       4.76\n1002 1802  96 5.41       6.15       4.66\n1003 1803 110 5.31       5.98       4.64\n1004 1804 104 5.30       5.99       4.61\n1005 1805  93 5.23       5.92       4.53\n1006 1806 114 5.05       5.64       4.46\n1007 1807 116 5.07       5.68       4.47\n1008 1808  98 5.14       5.76       4.51\n1009 1809 107 4.94       5.57       4.32\n1010 1810 100 4.96       5.57       4.36\n1011 1811 110 4.90       5.45       4.35\n1012 1812 120 5.03       5.62       4.44\n1013 1813 107 5.15       5.71       4.58\n1014 1814 113 5.15       5.71       4.60\n1015 1815 111 5.25       5.82       4.69\n1016 1816 103 5.37       5.96       4.79\n1017 1817 110 5.34       5.92       4.76\n1018 1818 106 5.41       6.00       4.82\n1019 1819 106 5.46       6.09       4.84\n1020 1820  95 5.44       6.06       4.82\n1021 1821 109 5.37       6.03       4.72\n1022 1822 102 5.34       5.97       4.71\n1023 1823 106 5.34       6.02       4.65\n1024 1824 108 5.38       6.11       4.64\n1025 1825 114 5.44       6.22       4.66\n1026 1826 109 5.47       6.17       4.77\n1027 1827 100 5.48       6.16       4.79\n1028 1828 113 5.44       6.18       4.71\n1029 1829 112 5.47       6.14       4.80\n1030 1830 105 5.46       6.08       4.84\n1031 1831 114 5.50       6.18       4.83\n1032 1832 113 5.48       6.10       4.86\n1033 1833 107 5.44       6.05       4.82\n1034 1834 111 5.45       6.07       4.84\n1035 1835 112 5.58       6.23       4.94\n1036 1836 112 5.67       6.32       5.03\n1037 1837 111 5.77       6.41       5.14\n1038 1838 109 5.84       6.47       5.21\n1039 1839 120 5.87       6.50       5.25\n1040 1840 105 6.06       6.64       5.48\n1041 1841 107 6.07       6.65       5.49\n1042 1842  96 6.08       6.69       5.48\n1043 1843 106 6.01       6.58       5.45\n1044 1844 106 6.00       6.57       5.43\n1045 1845 102 6.03       6.60       5.46\n1046 1846  98 5.94       6.52       5.36\n1047 1847 107 5.89       6.45       5.33\n1048 1848 102 5.95       6.52       5.38\n1049 1849 100 5.96       6.54       5.37\n1050 1850 109 5.86       6.44       5.28\n1051 1851 102 5.83       6.41       5.26\n1052 1852 113 5.88       6.50       5.26\n1053 1853 102 5.93       6.51       5.35\n1054 1854 102 5.86       6.44       5.28\n1055 1855 101 5.76       6.35       5.17\n1056 1856 111 5.69       6.28       5.11\n1057 1857 108 5.71       6.29       5.14\n1058 1858 104 5.72       6.29       5.15\n1059 1859 110 5.67       6.25       5.10\n1060 1860 113 5.79       6.38       5.20\n1061 1861 100 5.92       6.50       5.33\n1062 1862 117 5.78       6.39       5.17\n1063 1863 118 5.86       6.46       5.25\n1064 1864 105 6.04       6.64       5.45\n1065 1865  97 6.02       6.65       5.40\n1066 1866 102 5.94       6.51       5.37\n1067 1867 101 5.90       6.45       5.35\n1068 1868 104 5.83       6.37       5.30\n1069 1869 105 5.88       6.42       5.35\n1070 1870  99 5.91       6.45       5.38\n1071 1871 104 5.88       6.42       5.34\n1072 1872  NA 5.94       6.52       5.35\n1073 1873 104 6.01       6.62       5.41\n1074 1874 107 5.97       6.57       5.38\n1075 1875 103 5.99       6.58       5.41\n1076 1876 111 5.97       6.57       5.38\n1077 1877 104 6.05       6.61       5.48\n1078 1878 101 6.07       6.65       5.48\n1079 1879 102 6.00       6.59       5.41\n1080 1880 110 5.98       6.58       5.37\n1081 1881 112 6.09       6.71       5.46\n1082 1882  97 6.15       6.72       5.58\n1083 1883 107 6.09       6.69       5.49\n1084 1884 109 6.14       6.74       5.54\n1085 1885 113 6.20       6.79       5.62\n1086 1886 108 6.22       6.72       5.71\n1087 1887 109 6.27       6.76       5.77\n1088 1888 107 6.31       6.78       5.84\n1089 1889 109 6.35       6.83       5.87\n1090 1890  98 6.40       6.86       5.93\n1091 1891  99 6.34       6.81       5.87\n1092 1892 115 6.33       6.82       5.85\n1093 1893 109 6.51       6.94       6.08\n1094 1894  98 6.48       6.92       6.04\n1095 1895  NA 6.38       6.81       5.95\n1096 1896 106 6.33       6.76       5.90\n1097 1897 106 6.32       6.77       5.86\n1098 1898 108 6.30       6.79       5.82\n1099 1899  99 6.35       6.85       5.86\n1100 1900 102 6.40       6.86       5.95\n1101 1901 102 6.37       6.83       5.92\n1102 1902  98 6.34       6.80       5.89\n1103 1903  99 6.27       6.70       5.84\n1104 1904 108 6.22       6.63       5.81\n1105 1905 105 6.28       6.69       5.87\n1106 1906 105 6.22       6.67       5.78\n1107 1907 103 6.27       6.72       5.82\n1108 1908 102 6.32       6.77       5.86\n1109 1909 108 6.30       6.75       5.84\n1110 1910 104 6.28       6.75       5.81\n1111 1911  98 6.32       6.79       5.84\n1112 1912 105 6.32       6.83       5.82\n1113 1913 103 6.36       6.87       5.85\n1114 1914 102 6.38       6.92       5.85\n1115 1915 102 6.38       6.94       5.81\n1116 1916 112 6.42       7.05       5.79\n1117 1917 103 6.47       7.01       5.93\n1118 1918 104 6.47       7.03       5.92\n1119 1919  NA 6.44       6.98       5.90\n1120 1920 104 6.50       7.04       5.96\n1121 1921  NA 6.55       7.12       5.98\n1122 1922 101 6.55       7.09       6.02\n1123 1923  97 6.55       7.11       6.00\n1124 1924 111 6.55       7.17       5.93\n1125 1925 108 6.68       7.27       6.08\n1126 1926 108 6.76       7.34       6.18\n1127 1927 107 6.80       7.33       6.27\n1128 1928 107 6.88       7.39       6.36\n1129 1929 103 7.02       7.60       6.45\n1130 1930  95 7.10       7.71       6.49\n1131 1931 105 7.06       7.72       6.40\n1132 1932 105 7.09       7.71       6.46\n1133 1933 106 7.12       7.72       6.53\n1134 1934 104 7.19       7.76       6.62\n1135 1935 102 7.13       7.67       6.60\n1136 1936 111 7.18       7.73       6.63\n1137 1937 100 7.31       7.80       6.83\n1138 1938  98 7.32       7.82       6.83\n1139 1939 104 7.29       7.79       6.79\n1140 1940 110 7.27       7.75       6.79\n1141 1941 100 7.39       7.82       6.95\n1142 1942  96 7.40       7.83       6.96\n1143 1943 101 7.38       7.82       6.94\n1144 1944 100 7.40       7.84       6.95\n1145 1945  NA 7.39       7.84       6.95\n1146 1946  97 7.41       7.84       6.98\n1147 1947 107 7.45       7.94       6.97\n1148 1948 102 7.48       7.92       7.05\n1149 1949 107 7.53       7.97       7.09\n1150 1950  99 7.58       7.98       7.18\n1151 1951  98 7.58       7.98       7.18\n1152 1952 105 7.63       8.06       7.20\n1153 1953 101 7.68       8.09       7.27\n1154 1954  98 7.61       8.06       7.16\n1155 1955  97 7.60       8.05       7.15\n1156 1956  99 7.55       8.00       7.10\n1157 1957 103 7.59       8.05       7.14\n1158 1958  99 7.56       8.05       7.08\n1159 1959  92 7.63       8.11       7.14\n1160 1960  95 7.67       8.22       7.12\n1161 1961  99 7.65       8.22       7.07\n1162 1962 102 7.70       8.31       7.09\n1163 1963 101 7.75       8.35       7.14\n1164 1964  99 7.76       8.36       7.17\n1165 1965 110 7.76       8.35       7.17\n1166 1966  97 7.83       8.32       7.33\n1167 1967  97 7.83       8.33       7.32\n1168 1968  99 7.89       8.46       7.32\n1169 1969 101 7.94       8.54       7.34\n1170 1970 107 7.95       8.52       7.37\n1171 1971  98 8.05       8.57       7.53\n1172 1972  99 8.12       8.69       7.55\n1173 1973  97 8.13       8.69       7.57\n1174 1974  99 8.18       8.78       7.58\n1175 1975 100 8.18       8.76       7.60\n1176 1976  99 8.20       8.77       7.63\n1177 1977  93 8.22       8.78       7.66\n1178 1978 104 8.20       8.78       7.61\n1179 1979  97 8.28       8.83       7.73\n1180 1980 102 8.30       8.86       7.74\n1181 1981  99   NA         NA         NA\n1182 1982  93   NA         NA         NA\n1183 1983  99   NA         NA         NA\n1184 1984 109   NA         NA         NA\n1185 1985  99   NA         NA         NA\n1186 1986 102   NA         NA         NA\n1187 1987  95   NA         NA         NA\n1188 1988 106   NA         NA         NA\n1189 1989  93   NA         NA         NA\n1190 1990  88   NA         NA         NA\n1191 1991  97   NA         NA         NA\n1192 1992  94   NA         NA         NA\n1193 1993  97   NA         NA         NA\n1194 1994  99   NA         NA         NA\n1195 1995  99   NA         NA         NA\n1196 1996 103   NA         NA         NA\n1197 1997  97   NA         NA         NA\n1198 1998  91   NA         NA         NA\n1199 1999  94   NA         NA         NA\n1200 2000 100   NA         NA         NA\n1201 2001  96   NA         NA         NA\n1202 2002  91   NA         NA         NA\n1203 2003  98   NA         NA         NA\n1204 2004  92   NA         NA         NA\n1205 2005  99   NA         NA         NA\n1206 2006  98   NA         NA         NA\n1207 2007  97   NA         NA         NA\n1208 2008  95   NA         NA         NA\n1209 2009  95   NA         NA         NA\n1210 2010  95   NA         NA         NA\n1211 2011  99   NA         NA         NA\n1212 2012 101   NA         NA         NA\n1213 2013  93   NA         NA         NA\n1214 2014  94   NA         NA         NA\n1215 2015  93   NA         NA         NA\n\nggplot(data = cherry, aes(x = year, y = temp))+geom_line()+labs(title = \"Cherry Blossom temperature in March)\")\n\nWarning: Removed 73 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n\n\n\n\n\n\n\n\n\nSpline Model Cherry Blossom\n\ncherry2 &lt;- cherry %&gt;% \n  filter(!is.na(temp))\n\nnum_knots &lt;- 15\nknot_list &lt;- quantile( cherry2$year, probs=seq(0,1,length.out=num_knots) )\n\n\nB &lt;- bs(cherry2$year,\n    knots=knot_list[-c(1,num_knots)] ,\n    degree=4 , intercept=TRUE )\n\nB_tib &lt;- as_tibble(B) \n\n\nB_tib_join &lt;- cbind(cherry2, B_tib)\n\nB_tib_join_long &lt;- B_tib_join %&gt;% \n  pivot_longer(cols = c(`1`, `2`,`3`, `4`,`5`, `6`,`7`, `8`,`9`, `10`,`11`, `12`,`13`, `14`, `15`, `16`, `17`),\n               names_to = \"knot\",\n               values_to = \"density\")\n\nggplot(data = B_tib_join_long, aes(x = year, y = (density),  color = as.factor(knot)))+geom_line()\n\nDon't know how to automatically pick scale for object of type\n&lt;bs/basis/matrix&gt;. Defaulting to continuous.\n\n\n\n\n\n\n\n\nb4_smooth &lt;- brm(\n  data = cherry2,\n  family = gaussian,\n  formula = temp ~ 1 + s(year, bs = \"bs\", k = 30),  # k sets number of basis functions\n  prior = c(\n    prior(normal(6, 10), class = Intercept),\n    prior(normal(0, 1), class = b),\n    prior(student_t(3, 0, 1), class = sds),      # Prior for smooth term\n    prior(exponential(1), class = sigma)\n  ),\n  backend = \"cmdstanr\", silent = 2,\n  iter = 2000,\n  warmup = 1000,\n  chains = 4,\n  cores = 4,\n  seed = 42,\n  control = list(adapt_delta = 0.99),\n  file = \"fits/b04.cherry_bspline\"\n)\n\nb4.1_smooth &lt;- brm(\n  data = cherry2,\n  family = gaussian,\n  formula = temp ~ 1 + s(year, bs = \"tp\"),  # k sets number of basis functions\n  prior = c(\n    prior(normal(6, 10), class = Intercept),\n    prior(normal(0, 1), class = b),\n    prior(student_t(3, 0, 1), class = sds),      # Prior for smooth term\n    prior(exponential(1), class = sigma)\n  ),\n  backend = \"cmdstanr\", silent = 2,\n  iter = 2000,\n  warmup = 1000,\n  chains = 4,\n  cores = 4,\n  seed = 42,\n  control = list(adapt_delta = 0.99),\n  file = \"fits/b04.cherry_thinSpline\"\n)\n\n\nyear_seq &lt;- tibble(year = seq(from = 800, to = 2000, by = 10))\n\nmu_temp_4 &lt;-\n  fitted(b4_smooth, \n         newdata = year_seq) %&gt;%\n  as_tibble() %&gt;%\n  # let's tack on the `weight` values from `weight_seq`\n  bind_cols(year_seq)\n\npred_temp_4 &lt;-\n  predict(b4_smooth,\n          newdata = year_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(year_seq)\n  \n# pred_temp_4 %&gt;%\n#   slice(1:6)\n\n\nmu_temp_4.1 &lt;-\n  fitted(b4.1_smooth, \n         newdata = year_seq) %&gt;%\n  as_tibble() %&gt;%\n  # let's tack on the `weight` values from `weight_seq`\n  bind_cols(year_seq)\n\npred_temp_4.1 &lt;-\n  predict(b4.1_smooth,\n          newdata = year_seq) %&gt;%\n  as_tibble() %&gt;%\n  bind_cols(year_seq)\n  \n# pred_temp_4.1 %&gt;%\n#   slice(1:6)\n\n\n\nPlots Cherry Blossom\n\ncherry2 %&gt;%\n  ggplot(aes(x = year)) +\n  geom_ribbon(data = pred_temp_4, \n              aes(ymin = Q2.5, ymax = Q97.5),\n              fill = \"grey83\") +\n  geom_smooth(data = mu_temp_4,\n              aes(y = Estimate, ymin = Q2.5, ymax = Q97.5),\n              stat = \"identity\",\n              fill = \"grey70\", color = \"black\", alpha = 1, linewidth = 1/2) +\n  geom_point(aes(y = temp),\n             color = \"navyblue\", shape = 1, size = 1.5, alpha = 2/3) +\n  ylab(\"temp\") +\n  labs(title = \"15 knot B-splines\")\n\n\n\n\n\n\n\ncherry2 %&gt;%\n  ggplot(aes(x = year)) +\n  geom_ribbon(data = pred_temp_4.1, \n              aes(ymin = Q2.5, ymax = Q97.5),\n              fill = \"grey83\") +\n  geom_smooth(data = mu_temp_4.1,\n              aes(y = Estimate, ymin = Q2.5, ymax = Q97.5),\n              stat = \"identity\",\n              fill = \"grey70\", color = \"black\", alpha = 1, linewidth = 1/2) +\n  geom_line(aes(y = temp),\n             color = \"navyblue\", shape = 1) +\n  ylab(\"temp\") +\n  labs(title = \"Thin Plated Spline\")\n\nWarning in geom_line(aes(y = temp), color = \"navyblue\", shape = 1): Ignoring\nunknown parameters: `shape`\n\n\n\n\n\n\n\n\n# I am confused as to why the the Thin plated splines don't go more crazy and try to fit all of the contours"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistical Rethinking Homepage",
    "section": "",
    "text": "Welcome\nThis site showcases my Quarto projects.\nSee the GitHub source here."
  }
]