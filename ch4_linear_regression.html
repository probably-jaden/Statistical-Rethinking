<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ch4 â€“ Statistical Rethinking Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Statistical Rethinking Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ch4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="first-model" class="level2">
<h2 class="anchored" data-anchor-id="first-model">4.3.1 First Model</h2>
<p>!khun</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: cmdstanr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is cmdstanr version 0.9.0.9000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStan path: /Users/jaden/.cmdstan/cmdstan-2.36.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStan version: 2.36.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: posterior</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is posterior version 1.6.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'posterior'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    mad, sd, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    %in%, match</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>rethinking (Version 2.42)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rethinking'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    rstudent</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>kHeight <span class="ot">&lt;-</span> Howell1</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"cherry_blossoms"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>cherry <span class="ot">&lt;-</span> cherry_blossoms</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Howell1)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>rethinking, <span class="at">unload =</span> T)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.22.0). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.2     âœ” tibble    3.3.0
âœ” lubridate 1.9.4     âœ” tidyr     1.3.1
âœ” purrr     1.1.0     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metR)  <span class="co"># for geom_contour_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'metR'

The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Documents/Intellectual Fun/statisticalRethinking/statisticalRethinking"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eda-kung-height-weight-gender" class="level2">
<h2 class="anchored" data-anchor-id="eda-kung-height-weight-gender">EDA !Kung Height ~ Weight + Gender</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>kHeight_adult <span class="ot">&lt;-</span> kHeight <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>kHeight_child <span class="ot">&lt;-</span> kHeight <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kHeight, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height, <span class="at">color =</span> <span class="fu">as.factor</span>(male)))<span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Weight (kg)"</span>, <span class="at">y =</span> <span class="st">"Height (cm)"</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Kung! Height vs Weight"</span>, <span class="at">subtitle =</span> <span class="st">"By Gender"</span>)<span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Gender"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kHeight_adult, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height, <span class="at">color =</span> <span class="fu">as.factor</span>(male)))<span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Weight (kg)"</span>, <span class="at">y =</span> <span class="st">"Adult Height (cm)"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Kung! Adult Height vs Weight"</span>, <span class="at">subtitle =</span> <span class="st">"By Gender"</span>)<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Gender"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kHeight_child, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height, <span class="at">color =</span> <span class="fu">as.factor</span>(male)))<span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Weight (kg)"</span>, <span class="at">y =</span> <span class="st">"Child Height (cm)"</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Kung! Child Height vs Weight"</span>, <span class="at">subtitle =</span> <span class="st">"By Gender"</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Gender"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="plotting-the-prior" class="level3">
<h3 class="anchored" data-anchor-id="plotting-the-prior">Plotting the Prior</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean prior</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> .<span class="dv">1</span>)), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>))) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior Mean for Height"</span>, <span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior distribution of height prior and mean</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">sample_mu    =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">178</span>,       <span class="at">sd  =</span> <span class="dv">20</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">sample_sigma =</span> <span class="fu">runif</span>(n, <span class="at">min  =</span> <span class="dv">0</span>,         <span class="at">max =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> sample_mu, <span class="at">sd  =</span> sample_sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">color =</span> <span class="st">"prior height distribution"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">adjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_mu, <span class="at">color =</span> <span class="st">"prior mean"</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">adjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"prior height distribution"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"prior mean"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(Prior<span class="sc">~</span>predictive<span class="sc">~</span>distribution<span class="sc">~</span><span class="st">"for"</span><span class="sc">~</span><span class="fu">italic</span>(h[i])),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (cm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span>  <span class="co"># removes legend title</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="grid-approximation-technique" class="level3">
<h3 class="anchored" data-anchor-id="grid-approximation-technique">Grid approximation technique</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we'll accomplish with `tidyr::crossing()` what McElreath did with base R `expand.grid()`</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">mu    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">130</span>, <span class="at">to =</span> <span class="dv">180</span>, <span class="at">length.out =</span> n),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,   <span class="at">to =</span> <span class="dv">15</span>,   <span class="at">length.out =</span> n))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>grid_function <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma) {</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(kHeight_adult<span class="sc">$</span>height, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_likelihood =</span> <span class="fu">map2</span>(mu, sigma, grid_function)) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(log_likelihood) <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_mu    =</span> <span class="fu">dnorm</span>(mu,    <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd  =</span> <span class="dv">10</span>, <span class="at">log =</span> T),</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_sigma =</span> <span class="fu">dunif</span>(sigma, <span class="at">min  =</span> <span class="dv">0</span>,   <span class="at">max =</span> <span class="dv">10</span>, <span class="at">log =</span> T),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">product =</span> log_likelihood <span class="sc">+</span> prior_mu <span class="sc">+</span> prior_sigma,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> <span class="fu">exp</span>(product<span class="sc">-</span> <span class="fu">max</span>(product)),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_product =</span> prior_mu <span class="sc">+</span> prior_sigma,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_probability =</span> <span class="fu">exp</span>(prior_product <span class="sc">-</span> <span class="fu">max</span>(prior_product)))</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>prior_grid <span class="ot">&lt;-</span> </span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">prior_mu =</span> <span class="fu">log</span>(<span class="fu">rnorm</span>(<span class="fl">1e5</span>, <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd =</span> <span class="dv">10</span>)),</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_sigma =</span> <span class="fu">log</span>(<span class="fu">runif</span>(<span class="fl">1e5</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> prior_mu <span class="sc">+</span> prior_sigma,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> <span class="fu">exp</span>(product <span class="sc">-</span> <span class="fu">max</span>(product)))</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>prior_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_grid) <span class="sc">+</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">color =</span> prior_probability), <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Prior Probability"</span>, <span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior"</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>posterior_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_grid) <span class="sc">+</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">color =</span> probability), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Posterior Probability"</span>,  <span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior"</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>prior_plot <span class="sc">+</span> posterior_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_grid) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">color =</span> <span class="st">"Prior"</span>, <span class="at">alpha =</span> prior_probability)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">color =</span> <span class="st">"Posterior"</span>, <span class="at">alpha =</span> probability)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prior"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Posterior"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha</span>(<span class="at">name =</span> <span class="st">"Normalized Likelihood"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior vs Posterior"</span>, <span class="at">color =</span> <span class="st">"Distribution"</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sample-from-the-posterior" class="level3">
<h3 class="anchored" data-anchor-id="sample-from-the-posterior">Sample from the Posterior</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="ot">&lt;-</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> T, <span class="at">weight =</span> probability)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma)) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu[samples]),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma[samples])) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-intercept-only" class="level3">
<h3 class="anchored" data-anchor-id="model-intercept-only">model intercept only</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight_adult, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">50</span>)),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">seed =</span> <span class="dv">4</span>, <span class="at">file =</span> <span class="st">"fits/b04.011"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b4<span class="fl">.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: StanHeaders</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
rstan version 2.32.7 (Stan version 2.32.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)
For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,
change `threads_per_chain` option:
rstan_options(threads_per_chain = 1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:posterior':

    ess_bulk, ess_tail</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="extremely-narrow-priors" class="level4">
<h4 class="anchored" data-anchor-id="extremely-narrow-priors">Extremely Narrow Priors</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight_adult, <span class="at">family =</span> gaussian,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">150</span>, <span class="dv">2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="at">class =</span> sigma, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub =</span> <span class="dv">6</span>)),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.02.6"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b4<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/bad priors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.2</span>_draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(b4<span class="fl">.2</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.2</span>_draws <span class="ot">&lt;-</span> b4<span class="fl">.2</span>_draws <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_mu =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">150</span>, <span class="dv">2</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_sigma =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(b4<span class="fl">.2</span>_draws, ) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_Intercept, <span class="at">y =</span> sigma), <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_Intercept, <span class="at">y =</span> sigma), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">bins =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> prior_mu, <span class="at">y =</span> prior_sigma), <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="fu">aes</span>(<span class="at">x =</span> prior_mu, <span class="at">y =</span> prior_sigma), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">bins =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu), <span class="at">y =</span> <span class="fu">expression</span>(sigma),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Posterior Contours of mu and sigma"</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/bad priors-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="adding-linear-predictor" class="level2">
<h2 class="anchored" data-anchor-id="adding-linear-predictor">Adding Linear Predictor</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>kHeight_adult <span class="ot">&lt;-</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  kHeight_adult <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_c =</span> weight <span class="sc">-</span> <span class="fu">mean</span>(weight))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.3</span> <span class="ot">&lt;-</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight_adult, </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight_c,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">50</span>)),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.03.2"</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(b4<span class="fl">.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_Intercept<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Dropping 'draws_df' class as required metadata was removed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            b_Intercept b_weight_c sigma
b_Intercept        1.00      -0.04  0.02
b_weight_c        -0.04       1.00  0.01
sigma              0.02       0.01  1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(b4<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">fitted</span>(b4<span class="fl">.3</span>, <span class="at">summary =</span> F)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new data</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>weight_seq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight_c =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">18</span>, <span class="at">to =</span> <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4<span class="fl">.3</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we name the columns after the `weight` values from which they were computed</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="sc">-</span><span class="dv">18</span><span class="sc">:</span><span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
â„¹ Using compatibility `.name_repair`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span>  mu <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(weight, height, <span class="sc">-</span>iter) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we might reformat `weight` to numerals</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> <span class="fu">as.numeric</span>(weight))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> mu, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height), <span class="at">alpha =</span> .<span class="dv">002</span>, <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> kHeight_adult, <span class="fu">aes</span>(<span class="at">x =</span> weight_c, <span class="at">y =</span> height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="plot-prediction-error" class="level4">
<h4 class="anchored" data-anchor-id="plot-prediction-error">plot prediction error</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pred_height <span class="ot">&lt;-</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(b4<span class="fl">.3</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(weight_seq)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>pred_height <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 5
  Estimate Est.Error  Q2.5 Q97.5 weight_c
     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1     138.      5.14  128.  148.      -18
2     139.      5.11  129.  150.      -17
3     140.      5.13  130.  150.      -16
4     141.      5.09  131.  151.      -15
5     142.      5.24  132.  153.      -14
6     143.      5.16  132.  153.      -13</code></pre>
</div>
</div>
</section>
</section>
<section id="model-and-plot-quadratic-kung-height" class="level2">
<h2 class="anchored" data-anchor-id="model-and-plot-quadratic-kung-height">model and plot Quadratic !Kung height</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>kHeight <span class="ot">&lt;-</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  kHeight <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_s =</span> (weight <span class="sc">-</span> <span class="fu">mean</span>(weight)) <span class="sc">/</span> <span class="fu">sd</span>(weight))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight_s <span class="sc">+</span> <span class="fu">I</span>(weight_s<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">50</span>)),</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.05.1.1"</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>weight_seq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight_s =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(kHeight<span class="sc">$</span>weight_s) <span class="sc">-</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sd</span>(kHeight<span class="sc">$</span>weight_s)),</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">to =</span> <span class="fu">max</span>(kHeight<span class="sc">$</span>weight_s) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sd</span>(kHeight<span class="sc">$</span>weight_s)), </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">length.out =</span> <span class="dv">30</span>))</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4<span class="fl">.5</span>, </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(weight_seq)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(b4<span class="fl">.5</span>, </span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(weight_seq) </span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weight_s)) <span class="sc">+</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> p, </span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey83"</span>) <span class="sc">+</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> f,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">"identity"</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> height),</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"navyblue"</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(kHeight<span class="sc">$</span>weight_s)) <span class="sc">+</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/model and plot quadratic kung height-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="polynomial-cubic-model-kung-height" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-cubic-model-kung-height">polynomial (Cubic) model !Kung height</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight_s <span class="sc">+</span> <span class="fu">I</span>(weight_s<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(weight_s<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">50</span>)),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.06"</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># can't remember why I fit this model, I don't remember it being in the book</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.7</span> <span class="ot">&lt;-</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight_s,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">50</span>)),</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.07"</span>)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4<span class="fl">.6</span>, </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(weight_seq)</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(b4<span class="fl">.6</span>, </span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(weight_seq) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-polynomial-cubic-kung-height" class="level3">
<h3 class="anchored" data-anchor-id="plot-polynomial-cubic-kung-height">plot Polynomial (Cubic) !Kung height</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>at <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weight_s)) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> p, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey83"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> f,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">"identity"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> height),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"navyblue"</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(kHeight<span class="sc">$</span>weight_s)) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here it is!</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"standardized weight converted back"</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> at,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">round</span>(at <span class="sc">*</span> <span class="fu">sd</span>(kHeight<span class="sc">$</span>weight) <span class="sc">+</span> <span class="fu">mean</span>(kHeight<span class="sc">$</span>weight), <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/plot height cubic polynomial-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="splines" class="level2">
<h2 class="anchored" data-anchor-id="splines">Splines!</h2>
<section id="eda-cherry-blossom-data" class="level3">
<h3 class="anchored" data-anchor-id="eda-cherry-blossom-data">EDA cherry blossom data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>rethinking (Version 2.42)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rethinking'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:rstan':

    stan, traceplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:brms':

    LOO, stancode, WAIC</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    rstudent</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>cherry</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year doy temp temp_upper temp_lower
1     801  NA   NA         NA         NA
2     802  NA   NA         NA         NA
3     803  NA   NA         NA         NA
4     804  NA   NA         NA         NA
5     805  NA   NA         NA         NA
6     806  NA   NA         NA         NA
7     807  NA   NA         NA         NA
8     808  NA   NA         NA         NA
9     809  NA   NA         NA         NA
10    810  NA   NA         NA         NA
11    811  NA   NA         NA         NA
12    812  92   NA         NA         NA
13    813  NA   NA         NA         NA
14    814  NA   NA         NA         NA
15    815 105   NA         NA         NA
16    816  NA   NA         NA         NA
17    817  NA   NA         NA         NA
18    818  NA   NA         NA         NA
19    819  NA   NA         NA         NA
20    820  NA   NA         NA         NA
21    821  NA   NA         NA         NA
22    822  NA   NA         NA         NA
23    823  NA   NA         NA         NA
24    824  NA   NA         NA         NA
25    825  NA   NA         NA         NA
26    826  NA   NA         NA         NA
27    827  NA   NA         NA         NA
28    828  NA   NA         NA         NA
29    829  NA   NA         NA         NA
30    830  NA   NA         NA         NA
31    831  96   NA         NA         NA
32    832  NA   NA         NA         NA
33    833  NA   NA         NA         NA
34    834  NA   NA         NA         NA
35    835  NA   NA         NA         NA
36    836  NA   NA         NA         NA
37    837  NA   NA         NA         NA
38    838  NA   NA         NA         NA
39    839  NA 5.87      10.99       0.75
40    840  NA 5.99      10.78       1.21
41    841  NA 6.12      10.60       1.64
42    842  NA 6.25      10.47       2.02
43    843  NA 6.37      10.39       2.35
44    844  NA 6.50      10.37       2.63
45    845  NA 6.62      10.42       2.83
46    846  NA 6.75      10.54       2.96
47    847  NA 6.88      10.73       3.03
48    848  NA 7.00      10.99       3.02
49    849  NA 7.13      11.31       2.95
50    850  NA 7.25      11.68       2.83
51    851 108 7.38      12.10       2.66
52    852  NA   NA         NA         NA
53    853 104   NA         NA         NA
54    854  NA   NA         NA         NA
55    855  NA   NA         NA         NA
56    856  NA   NA         NA         NA
57    857  NA   NA         NA         NA
58    858  NA   NA         NA         NA
59    859  NA   NA         NA         NA
60    860  NA   NA         NA         NA
61    861  NA 6.63      10.21       3.05
62    862  NA 6.51       9.40       3.62
63    863  NA 6.44       9.31       3.56
64    864 100 6.42       8.69       4.14
65    865  NA 6.44       8.54       4.34
66    866 106 6.44       8.11       4.77
67    867  NA   NA         NA         NA
68    868  NA   NA         NA         NA
69    869  95   NA         NA         NA
70    870  NA   NA         NA         NA
71    871  NA   NA         NA         NA
72    872  NA   NA         NA         NA
73    873  NA   NA         NA         NA
74    874  NA   NA         NA         NA
75    875  NA   NA         NA         NA
76    876  NA 5.60       7.05       4.15
77    877  NA 5.71       7.00       4.42
78    878  NA 5.82       7.63       4.01
79    879  NA 5.95       7.66       4.24
80    880  NA 6.08       7.73       4.44
81    881  NA 6.22       7.84       4.59
82    882  NA 6.40       8.45       4.36
83    883  NA 6.23       7.57       4.89
84    884  NA 6.30       7.62       4.97
85    885  NA 6.36       7.70       5.03
86    886  NA 6.43       7.79       5.08
87    887  NA 6.65       8.23       5.08
88    888  NA 6.74       8.34       5.14
89    889 104 6.83       8.48       5.19
90    890  NA 6.88       8.79       4.97
91    891 109 6.98       8.96       5.00
92    892 108 7.11       9.11       5.11
93    893  NA 6.93       8.34       5.53
94    894 106 6.98       8.40       5.55
95    895 104 7.08       8.57       5.58
96    896 104 7.20       8.69       5.72
97    897  NA 7.35       9.09       5.60
98    898  NA 7.36       9.05       5.67
99    899  NA 7.37       9.03       5.70
100   900  NA 7.45       8.91       5.99
101   901  NA 7.48       8.92       6.04
102   902 102 7.50       8.95       6.06
103   903  NA 7.40       9.01       5.79
104   904  NA 7.37       8.95       5.80
105   905  NA 7.34       8.90       5.79
106   906  NA 7.32       8.88       5.75
107   907  NA 7.29       8.87       5.70
108   908  98 7.26       8.89       5.62
109   909  NA 7.21       9.10       5.31
110   910  NA 7.19       9.16       5.21
111   911  NA 6.85       8.85       4.84
112   912  95 6.78       8.83       4.74
113   913 110 6.61       8.59       4.63
114   914  NA 6.92      10.29       3.55
115   915  NA 6.77      10.21       3.34
116   916  NA 6.63      10.18       3.07
117   917  95 6.48      10.21       2.76
118   918  NA 6.33      10.10       2.56
119   919  NA 6.40       9.07       3.73
120   920  NA 6.80       8.52       5.08
121   921  NA 6.79       8.50       5.07
122   922  NA 6.77       8.49       5.05
123   923 104 6.76       8.50       5.01
124   924  NA 6.84       9.15       4.53
125   925  NA 7.40       9.95       4.84
126   926  98 7.45      10.01       4.90
127   927  NA 6.82       9.60       4.05
128   928  NA 6.68       9.07       4.29
129   929  NA 6.78       8.87       4.69
130   930  97 6.81       8.63       4.98
131   931  NA 6.47       9.48       3.47
132   932  NA 6.58       9.43       3.74
133   933 106 6.72       9.41       4.03
134   934  NA 6.49      10.03       2.96
135   935  NA 6.71       9.53       3.90
136   936  NA 6.83       9.28       4.38
137   937  NA 6.94       9.02       4.87
138   938  NA 7.02       8.96       5.08
139   939  NA 7.10       8.84       5.35
140   940  NA 7.17       8.82       5.52
141   941 109 7.25       8.82       5.67
142   942  NA 7.56       9.11       6.01
143   943  NA 7.54       9.00       6.08
144   944  NA 7.47       8.90       6.05
145   945  NA 7.43       8.73       6.14
146   946  NA 7.39       8.64       6.14
147   947  NA 7.23       8.57       5.90
148   948  NA 7.16       8.48       5.84
149   949 107 7.10       8.35       5.85
150   950  95 7.20       8.65       5.75
151   951  NA 7.08       8.55       5.61
152   952  NA 6.97       8.45       5.48
153   953  NA 6.85       8.38       5.33
154   954  NA 6.74       8.33       5.16
155   955  89 7.07       8.37       5.77
156   956  NA 6.94       8.16       5.73
157   957 112 6.93       8.21       5.66
158   958 109 6.96       8.34       5.58
159   959  97 7.14       8.43       5.85
160   960 101 7.07       8.45       5.69
161   961  87 7.06       8.44       5.69
162   962  NA 6.84       7.87       5.81
163   963  94 6.82       7.88       5.76
164   964  NA 6.73       7.76       5.69
165   965 104 6.74       7.83       5.66
166   966  98 6.76       7.97       5.55
167   967 103 6.75       8.16       5.34
168   968  NA 6.79       8.45       5.12
169   969  98 6.84       8.61       5.07
170   970  NA 6.48       7.95       5.00
171   971  NA 6.52       8.05       4.99
172   972 107 6.57       8.17       4.98
173   973  NA 6.64       8.38       4.90
174   974 108 5.91       7.78       4.05
175   975 101 5.98       8.32       3.64
176   976  NA 6.20       8.16       4.23
177   977 112 6.16       7.85       4.48
178   978  NA 6.57       8.89       4.24
179   979 104 6.48       8.77       4.20
180   980  NA 6.74      10.03       3.44
181   981  NA 6.60       9.81       3.39
182   982  NA 6.46       9.63       3.29
183   983  NA 6.32       9.49       3.15
184   984  NA 6.08       9.39       2.77
185   985  94 5.92       9.23       2.61
186   986  NA 5.64       8.16       3.12
187   987  NA 5.79       7.64       3.95
188   988  NA 5.67       7.48       3.86
189   989 100 5.80       7.31       4.28
190   990  NA 5.53       7.18       3.88
191   991 104 5.53       7.11       3.94
192   992  NA 5.29       7.34       3.24
193   993  NA 5.32       7.24       3.40
194   994  NA 5.35       7.17       3.53
195   995  NA 5.38       7.14       3.63
196   996  NA 5.42       7.14       3.69
197   997  NA 5.45       7.18       3.71
198   998  NA 5.48       7.27       3.69
199   999  NA 5.14       6.80       3.48
200  1000 105 5.10       6.80       3.41
201  1001  NA 5.41       7.24       3.57
202  1002  NA 5.30       6.88       3.72
203  1003  NA 5.41       6.91       3.92
204  1004 117 5.62       7.22       4.03
205  1005  NA 5.89       7.38       4.41
206  1006 100 5.92       7.27       4.57
207  1007 106 5.73       7.32       4.14
208  1008  NA 5.66       7.53       3.79
209  1009  NA 5.74       7.56       3.92
210  1010  NA 5.82       7.62       4.03
211  1011  NA 5.87       7.49       4.24
212  1012  NA 5.94       7.57       4.32
213  1013  NA 6.02       7.66       4.38
214  1014 115 6.09       7.77       4.41
215  1015  NA 6.26       7.82       4.70
216  1016 111 6.26       7.64       4.89
217  1017  99 6.39       7.78       5.01
218  1018 113 6.04       7.45       4.64
219  1019  98 6.32       7.93       4.71
220  1020  NA 6.11       7.62       4.60
221  1021  NA 6.10       7.55       4.65
222  1022  NA 6.08       7.49       4.67
223  1023  NA 6.07       7.47       4.67
224  1024  NA 6.06       7.47       4.65
225  1025  NA 6.04       7.49       4.59
226  1026  NA 6.03       7.54       4.52
227  1027  NA 6.02       7.61       4.42
228  1028  NA 6.01       7.70       4.31
229  1029 116 5.99       7.81       4.18
230  1030  NA 6.01       7.62       4.40
231  1031  97 6.63       7.97       5.29
232  1032 111 6.53       8.01       5.04
233  1033 102 6.68       8.18       5.19
234  1034  96 6.67       8.42       4.91
235  1035  NA 6.45       8.62       4.28
236  1036 104 6.34       7.98       4.70
237  1037  NA 6.29       8.37       4.21
238  1038  NA 6.34       8.40       4.27
239  1039  NA 6.38       8.46       4.31
240  1040  NA 6.43       8.54       4.31
241  1041 103 6.01       7.82       4.21
242  1042  NA 5.95       8.12       3.78
243  1043  NA 6.02       7.81       4.24
244  1044  NA 6.02       7.79       4.26
245  1045  NA 6.03       7.80       4.26
246  1046 103 6.03       7.82       4.24
247  1047  NA 5.96       8.15       3.77
248  1048 112 5.98       8.20       3.75
249  1049  NA 6.22       8.97       3.48
250  1050 105 6.36       8.38       4.34
251  1051  NA 6.53       9.42       3.63
252  1052  NA 6.48       9.27       3.69
253  1053  NA 6.65       8.97       4.32
254  1054  NA 6.35       9.09       3.60
255  1055  NA 6.28       8.94       3.62
256  1056  NA 6.21       8.81       3.61
257  1057  NA 6.14       8.72       3.56
258  1058  NA 6.19       8.32       4.07
259  1059  NA 6.14       8.26       4.03
260  1060 108 6.15       7.97       4.34
261  1061  92 6.33       8.59       4.07
262  1062  NA 5.73       7.72       3.75
263  1063  NA 5.75       7.44       4.06
264  1064  NA 5.77       7.41       4.12
265  1065  NA 5.87       7.43       4.32
266  1066 105 6.04       7.69       4.39
267  1067  NA 5.93       7.95       3.91
268  1068  NA 6.02       7.89       4.15
269  1069  NA 6.07       7.72       4.43
270  1070  NA 6.15       7.74       4.56
271  1071 113 6.23       7.79       4.68
272  1072  NA 6.45       7.72       5.19
273  1073 103 6.49       7.72       5.26
274  1074  NA 6.37       7.69       5.04
275  1075  NA 6.31       7.63       4.98
276  1076  NA 6.28       7.55       5.01
277  1077  NA 6.26       7.41       5.11
278  1078  NA 6.24       7.35       5.12
279  1079  NA 6.21       7.31       5.11
280  1080 102 6.19       7.29       5.09
281  1081  NA 6.02       7.23       4.80
282  1082  NA 6.03       7.13       4.93
283  1083  96 5.99       7.09       4.90
284  1084 120 5.90       6.91       4.89
285  1085  NA 6.25       7.19       5.31
286  1086  NA 6.20       7.13       5.27
287  1087  NA 6.12       7.05       5.18
288  1088 104 6.16       6.98       5.35
289  1089  NA 6.16       7.04       5.27
290  1090 105 6.16       6.97       5.36
291  1091  NA 6.18       7.07       5.29
292  1092  NA 6.13       7.03       5.24
293  1093 105 5.99       6.96       5.02
294  1094  NA 6.17       7.08       5.26
295  1095 100 6.06       7.00       5.12
296  1096  96 5.97       6.87       5.06
297  1097  NA 5.77       6.52       5.03
298  1098 100 5.70       6.45       4.96
299  1099 103 5.59       6.27       4.91
300  1100  NA 5.54       6.23       4.85
301  1101  NA 5.58       6.24       4.92
302  1102 104 5.60       6.24       4.95
303  1103  NA 5.54       6.25       4.83
304  1104 108 5.56       6.22       4.90
305  1105 114 5.58       6.28       4.88
306  1106  NA 5.74       6.39       5.09
307  1107 105 5.74       6.38       5.09
308  1108  NA 5.72       6.41       5.03
309  1109  NA 5.61       6.32       4.89
310  1110  NA 5.66       6.32       5.00
311  1111 113 5.58       6.24       4.92
312  1112 104 5.67       6.41       4.93
313  1113  NA 5.61       6.37       4.85
314  1114 100 5.56       6.32       4.79
315  1115  NA 5.48       6.13       4.83
316  1116  NA 5.45       6.10       4.80
317  1117 109 5.42       6.09       4.75
318  1118 102 5.42       6.17       4.67
319  1119  NA 5.35       6.08       4.62
320  1120 104 5.32       6.08       4.55
321  1121  NA 5.28       5.98       4.57
322  1122  NA 5.25       5.99       4.52
323  1123 112 5.23       6.00       4.46
324  1124  98 5.67       6.49       4.85
325  1125 111 5.61       6.48       4.74
326  1126 108 6.11       7.49       4.73
327  1127 107 6.18       7.67       4.69
328  1128 111 6.25       7.89       4.61
329  1129 106 6.26       7.69       4.82
330  1130 103 6.30       7.89       4.71
331  1131 103 5.97       7.45       4.49
332  1132  NA 5.87       7.64       4.10
333  1133  NA 5.73       7.19       4.27
334  1134 106 5.84       7.26       4.42
335  1135  NA 5.77       7.21       4.32
336  1136  NA 5.93       7.47       4.40
337  1137  NA 5.87       7.21       4.53
338  1138  NA 5.92       7.24       4.61
339  1139 113 5.83       7.02       4.65
340  1140 103 5.89       7.05       4.72
341  1141 111 5.82       7.08       4.56
342  1142  NA 6.04       7.34       4.74
343  1143 110 5.92       7.27       4.57
344  1144  NA 6.14       7.76       4.52
345  1145 107 6.02       7.59       4.45
346  1146  NA 6.27       8.20       4.34
347  1147  NA 6.11       7.93       4.29
348  1148  NA 5.95       7.68       4.22
349  1149  NA 5.88       7.36       4.40
350  1150  NA 5.88       7.15       4.61
351  1151 109 5.80       7.04       4.56
352  1152  NA 5.95       7.23       4.66
353  1153  NA 5.95       7.10       4.81
354  1154  96 5.82       7.00       4.65
355  1155  NA 5.59       6.73       4.45
356  1156  90 5.52       6.64       4.39
357  1157  NA 5.29       6.14       4.43
358  1158  NA 5.29       6.09       4.48
359  1159 103 5.28       6.08       4.48
360  1160  NA 5.17       5.97       4.37
361  1161 112 5.19       5.95       4.43
362  1162  NA 5.24       6.03       4.44
363  1163 112 5.23       6.03       4.42
364  1164 100 5.10       6.01       4.19
365  1165 106 5.00       5.89       4.11
366  1166  95 4.96       5.90       4.02
367  1167 111 4.83       5.69       3.98
368  1168  NA 4.85       5.77       3.94
369  1169 112 4.86       5.71       4.00
370  1170 113 4.98       5.84       4.13
371  1171  NA 5.26       6.24       4.28
372  1172 103 5.28       6.22       4.35
373  1173 117 5.24       6.22       4.27
374  1174 112 5.30       6.15       4.46
375  1175 113 5.39       6.21       4.56
376  1176 113 5.48       6.31       4.64
377  1177  NA 5.61       6.42       4.80
378  1178  NA 5.61       6.42       4.80
379  1179 103 5.61       6.43       4.80
380  1180  98 5.48       6.30       4.66
381  1181  NA 5.36       6.19       4.52
382  1182 104 5.52       6.42       4.61
383  1183 101 5.44       6.36       4.53
384  1184 115 5.38       6.43       4.33
385  1185 115 5.46       6.36       4.56
386  1186  NA 5.65       6.49       4.81
387  1187 104 5.70       6.53       4.87
388  1188 107 5.66       6.59       4.73
389  1189  NA 5.70       6.71       4.68
390  1190 112 5.69       6.58       4.79
391  1191 106 5.84       6.74       4.93
392  1192  NA 5.83       6.82       4.85
393  1193  NA 5.76       6.63       4.88
394  1194 119 5.79       6.65       4.93
395  1195  NA 6.01       6.72       5.30
396  1196  NA 6.00       6.67       5.32
397  1197  NA 5.92       6.60       5.24
398  1198  NA 5.89       6.57       5.21
399  1199 109 6.01       6.67       5.35
400  1200 104 6.10       6.76       5.45
401  1201  96 6.15       6.81       5.48
402  1202 106 6.18       7.01       5.36
403  1203 105 6.18       6.98       5.37
404  1204 110 6.20       7.05       5.34
405  1205 105 6.20       6.98       5.42
406  1206  NA 6.38       7.45       5.32
407  1207 104 6.45       7.50       5.40
408  1208  NA 6.47       7.60       5.35
409  1209  NA 6.55       7.68       5.43
410  1210 112 6.51       7.53       5.49
411  1211  NA 6.63       7.62       5.63
412  1212  98 6.67       7.69       5.65
413  1213 107 6.66       7.80       5.53
414  1214 102 6.55       7.58       5.51
415  1215 108 6.42       7.44       5.41
416  1216 101 6.56       7.58       5.54
417  1217  NA 6.47       7.49       5.46
418  1218  NA 6.49       7.51       5.47
419  1219 101 6.41       7.38       5.45
420  1220 109 6.19       7.23       5.15
421  1221  99 6.33       7.36       5.29
422  1222  NA 6.25       7.32       5.18
423  1223 116 6.24       7.32       5.16
424  1224  NA 6.30       7.43       5.18
425  1225 105 6.25       7.38       5.11
426  1226 106 6.23       7.47       4.99
427  1227 111 6.51       7.70       5.32
428  1228  NA 6.60       7.92       5.27
429  1229  97 6.74       7.92       5.56
430  1230 102 6.66       7.88       5.44
431  1231 101 6.64       7.96       5.32
432  1232  92 6.76       8.05       5.47
433  1233 105 6.27       7.64       4.91
434  1234  NA 6.33       7.70       4.95
435  1235 110 6.41       7.69       5.12
436  1236  87 6.55       7.92       5.17
437  1237  NA 6.09       7.31       4.87
438  1238  NA 6.12       7.26       4.99
439  1239  NA 6.19       7.28       5.10
440  1240 106 6.24       7.32       5.16
441  1241  NA 6.29       7.40       5.18
442  1242  NA 6.35       7.44       5.25
443  1243  NA 6.40       7.50       5.30
444  1244 108 6.46       7.57       5.34
445  1245 108 6.40       7.44       5.37
446  1246  98 6.47       7.54       5.39
447  1247 106 6.40       7.59       5.22
448  1248  NA 6.23       7.39       5.06
449  1249 108 6.29       7.38       5.19
450  1250 116 6.38       7.46       5.30
451  1251 100 6.61       7.71       5.51
452  1252  NA 6.56       7.72       5.39
453  1253  NA 6.55       7.62       5.49
454  1254 110 6.57       7.56       5.59
455  1255  NA 6.71       7.75       5.66
456  1256  NA 6.57       7.67       5.47
457  1257  94 6.46       7.57       5.35
458  1258  NA 6.27       7.25       5.29
459  1259  96 6.21       7.15       5.28
460  1260  NA 6.06       6.93       5.20
461  1261  NA 6.02       6.88       5.16
462  1262  97 5.98       6.80       5.16
463  1263 120 5.86       6.63       5.08
464  1264 103 6.15       6.88       5.42
465  1265  98 6.19       6.87       5.51
466  1266  NA 6.07       6.70       5.45
467  1267 105 6.05       6.67       5.42
468  1268 103 6.04       6.72       5.37
469  1269 100 6.01       6.72       5.30
470  1270  NA 5.93       6.62       5.23
471  1271 100 6.14       6.97       5.32
472  1272  NA 6.15       7.29       5.02
473  1273  NA 6.26       7.40       5.12
474  1274  NA 6.36       7.52       5.20
475  1275 107 6.47       7.67       5.27
476  1276  NA 6.56       7.86       5.27
477  1277  NA 6.46       7.55       5.37
478  1278 113 6.54       7.67       5.40
479  1279 101 6.65       7.67       5.62
480  1280 102 6.69       7.90       5.47
481  1281  NA 6.88       8.45       5.30
482  1282  NA 6.86       8.27       5.45
483  1283 103 6.96       8.41       5.51
484  1284 102 6.87       8.29       5.46
485  1285 105 6.56       7.80       5.31
486  1286 112 6.52       7.72       5.31
487  1287 110 6.65       7.67       5.63
488  1288 108 6.80       7.75       5.86
489  1289 107 6.72       7.83       5.61
490  1290  NA 6.89       8.19       5.59
491  1291  NA 6.88       8.04       5.72
492  1292 107 6.81       7.92       5.71
493  1293  NA 6.83       8.71       4.96
494  1294 101 6.82       8.43       5.21
495  1295 102 6.87       8.66       5.07
496  1296  NA 7.06       9.14       4.98
497  1297  NA 6.90       8.87       4.93
498  1298  NA 6.74       8.62       4.86
499  1299  NA 6.58       8.42       4.73
500  1300  NA 6.46       8.16       4.76
501  1301  95 6.31       7.98       4.65
502  1302  96 6.11       7.77       4.45
503  1303  NA 5.93       7.52       4.34
504  1304  NA 5.79       7.32       4.25
505  1305  NA 5.64       7.15       4.13
506  1306  NA 5.50       7.01       3.99
507  1307 104 5.35       6.89       3.82
508  1308  NA 5.24       6.93       3.55
509  1309  NA 5.07       6.84       3.31
510  1310  NA 4.90       6.77       3.04
511  1311  94 4.73       6.73       2.74
512  1312 100 4.88       6.30       3.45
513  1313  NA 4.77       6.18       3.36
514  1314 101 5.10       6.26       3.94
515  1315 111 5.03       6.22       3.84
516  1316 103 5.11       6.23       3.98
517  1317 102 5.03       6.09       3.96
518  1318  NA 4.93       6.08       3.79
519  1319 116 4.85       5.88       3.82
520  1320  NA 5.12       6.16       4.08
521  1321 102 4.99       5.98       4.01
522  1322 106 4.88       5.91       3.84
523  1323 124 4.82       5.96       3.68
524  1324  98 5.09       6.06       4.12
525  1325  NA 4.87       5.77       3.96
526  1326 107 4.69       5.56       3.83
527  1327  NA 4.67       5.56       3.79
528  1328  NA 4.67       5.47       3.86
529  1329 112 4.74       5.53       3.95
530  1330 108 4.89       5.82       3.97
531  1331 112 4.82       5.82       3.82
532  1332 115 4.87       5.94       3.79
533  1333  NA 5.16       6.20       4.12
534  1334  NA 5.17       6.09       4.24
535  1335  NA 5.16       6.03       4.30
536  1336  NA 5.15       5.96       4.34
537  1337  NA 5.20       6.08       4.32
538  1338  NA 5.36       6.64       4.09
539  1339  NA 5.52       6.90       4.14
540  1340  NA 5.56       6.79       4.32
541  1341  NA 5.64       6.85       4.44
542  1342 110 5.72       6.88       4.57
543  1343  NA 5.71       6.80       4.63
544  1344 102 5.78       6.85       4.71
545  1345  NA 5.71       6.86       4.57
546  1346 107 5.82       6.97       4.68
547  1347 109 5.81       6.95       4.68
548  1348  NA 5.85       6.96       4.73
549  1349 112 5.91       6.97       4.85
550  1350 101 6.02       7.03       5.00
551  1351 115 5.89       6.93       4.84
552  1352  NA 6.04       6.96       5.12
553  1353  NA 6.09       6.97       5.22
554  1354  NA 6.18       7.05       5.31
555  1355  NA 6.26       7.12       5.40
556  1356 117 6.28       7.09       5.48
557  1357 107 6.46       7.16       5.76
558  1358 110 6.54       7.24       5.84
559  1359 105 6.63       7.31       5.95
560  1360 101 6.67       7.37       5.97
561  1361 108 6.66       7.41       5.92
562  1362  NA 6.73       7.48       5.98
563  1363 107 6.76       7.53       5.99
564  1364 110 6.80       7.60       6.01
565  1365  NA 6.84       7.66       6.03
566  1366 112 6.83       7.69       5.97
567  1367  97 6.80       7.73       5.86
568  1368  88 6.71       7.59       5.83
569  1369  94 6.66       7.32       5.99
570  1370 109 6.68       7.36       6.00
571  1371  NA 6.72       7.28       6.16
572  1372 102 6.69       7.20       6.18
573  1373 110 6.64       7.13       6.15
574  1374  NA 6.70       7.13       6.27
575  1375 103 6.70       7.15       6.25
576  1376  99 6.72       7.16       6.29
577  1377 105 6.73       7.15       6.31
578  1378 104 6.57       7.09       6.06
579  1379 103 6.94       7.77       6.11
580  1380 102 6.94       7.76       6.12
581  1381 108 6.95       7.82       6.07
582  1382 105 7.18       8.11       6.26
583  1383 102 7.40       8.43       6.37
584  1384  98 7.43       8.53       6.33
585  1385  99 7.27       8.38       6.17
586  1386 105 7.19       8.34       6.03
587  1387 100 7.21       8.37       6.05
588  1388  99 7.18       8.44       5.91
589  1389  NA 6.98       8.47       5.49
590  1390  NA 7.07       8.44       5.70
591  1391  NA 7.07       8.30       5.83
592  1392  NA 7.07       8.23       5.91
593  1393  NA 7.07       8.14       6.00
594  1394  NA 7.06       8.05       6.08
595  1395  NA 7.08       7.99       6.16
596  1396  NA 7.10       7.95       6.24
597  1397  NA 7.10       7.90       6.29
598  1398 106 7.10       7.89       6.32
599  1399  NA 7.21       7.99       6.43
600  1400  NA 7.15       7.91       6.38
601  1401 101 7.13       7.86       6.40
602  1402 103 7.10       7.84       6.36
603  1403 104 7.16       7.90       6.42
604  1404  NA 7.11       7.96       6.26
605  1405  NA 7.14       7.93       6.35
606  1406 102 7.13       7.88       6.37
607  1407 101 7.12       7.88       6.36
608  1408 111 7.14       7.90       6.38
609  1409  86 7.26       8.03       6.49
610  1410 102 7.10       7.71       6.49
611  1411  NA 7.08       7.70       6.45
612  1412  93 7.05       7.68       6.43
613  1413  91 6.91       7.50       6.31
614  1414  NA 6.72       7.26       6.17
615  1415 105 6.71       7.26       6.17
616  1416 101 6.67       7.24       6.10
617  1417 109 6.56       7.18       5.94
618  1418  98 6.70       7.32       6.08
619  1419 100 6.75       7.35       6.15
620  1420 112 6.75       7.35       6.15
621  1421  99 6.84       7.41       6.26
622  1422 109 6.92       7.53       6.31
623  1423  96 6.94       7.54       6.33
624  1424 103 6.84       7.43       6.25
625  1425  98 6.91       7.51       6.31
626  1426  99 6.83       7.43       6.23
627  1427 102 6.77       7.37       6.17
628  1428  NA 6.68       7.32       6.04
629  1429  98 6.57       7.25       5.90
630  1430 108 6.45       7.14       5.76
631  1431 102 6.47       7.19       5.75
632  1432 104 6.43       7.16       5.71
633  1433  98 6.47       7.18       5.75
634  1434 113 6.41       7.09       5.72
635  1435  95 6.56       7.24       5.87
636  1436 101 6.46       7.09       5.82
637  1437 103 6.45       7.07       5.83
638  1438  99 6.47       7.08       5.86
639  1439 101 6.42       7.04       5.80
640  1440  98 6.38       7.02       5.74
641  1441 105 6.33       6.99       5.67
642  1442  NA 6.22       6.92       5.52
643  1443 107 6.20       6.91       5.49
644  1444 109 6.32       7.03       5.60
645  1445  NA 6.34       7.10       5.59
646  1446 108 6.40       7.12       5.68
647  1447 111 6.34       7.09       5.58
648  1448  96 6.23       7.12       5.35
649  1449  95 6.10       6.97       5.24
650  1450 100 6.04       6.81       5.28
651  1451 103 5.99       6.73       5.26
652  1452  92 5.95       6.69       5.21
653  1453 107 5.88       6.48       5.27
654  1454 105 5.99       6.63       5.36
655  1455  96 6.13       6.84       5.42
656  1456 106 6.09       6.85       5.33
657  1457 105 6.23       7.11       5.35
658  1458 112 6.24       7.12       5.36
659  1459 113 6.36       7.19       5.52
660  1460 111 6.52       7.32       5.72
661  1461 106 6.57       7.29       5.85
662  1462 106 6.56       7.25       5.86
663  1463 101 6.62       7.31       5.93
664  1464 104 6.56       7.26       5.86
665  1465  98 6.64       7.41       5.88
666  1466 105 6.60       7.43       5.77
667  1467 101 6.59       7.39       5.79
668  1468 101 6.58       7.44       5.71
669  1469  NA 6.47       7.34       5.60
670  1470  NA 6.55       7.41       5.69
671  1471  NA 6.59       7.39       5.79
672  1472 114 6.53       7.28       5.77
673  1473  NA 6.62       7.32       5.91
674  1474  98 6.52       7.24       5.80
675  1475  NA 6.44       7.15       5.73
676  1476 100 6.41       7.10       5.72
677  1477 110 6.34       7.03       5.65
678  1478 115 6.33       7.06       5.60
679  1479 110 6.45       7.19       5.71
680  1480 104 6.45       7.26       5.63
681  1481 106 6.38       7.26       5.51
682  1482 108 6.36       7.29       5.42
683  1483 101 6.34       7.36       5.32
684  1484  97 6.30       7.30       5.30
685  1485  94 6.17       7.17       5.18
686  1486  99 6.07       6.96       5.19
687  1487  93 6.01       6.85       5.17
688  1488 103 5.80       6.60       5.00
689  1489 100 5.73       6.55       4.91
690  1490  97 5.68       6.45       4.92
691  1491 107 5.59       6.28       4.90
692  1492 108 5.63       6.31       4.95
693  1493 100 5.62       6.32       4.92
694  1494 106 5.54       6.21       4.87
695  1495  94 5.56       6.21       4.91
696  1496  97 5.38       5.95       4.81
697  1497 108 5.31       5.80       4.82
698  1498  97 5.32       5.81       4.83
699  1499 111 5.23       5.66       4.80
700  1500  97 5.26       5.69       4.84
701  1501 103 5.21       5.62       4.80
702  1502 115 5.16       5.58       4.75
703  1503 108 5.20       5.56       4.84
704  1504 114 5.20       5.56       4.84
705  1505 106 5.37       5.81       4.93
706  1506 106 5.36       5.80       4.92
707  1507 108 5.34       5.79       4.90
708  1508 111 5.31       5.74       4.87
709  1509 102 5.23       5.70       4.76
710  1510 110 5.06       5.58       4.53
711  1511 111 5.07       5.60       4.54
712  1512 109 5.15       5.69       4.62
713  1513 110 5.06       5.66       4.47
714  1514 105 5.09       5.69       4.49
715  1515 111 5.16       5.77       4.56
716  1516 104 5.16       5.77       4.54
717  1517 106 5.16       5.76       4.56
718  1518 115 5.05       5.69       4.42
719  1519 111 5.04       5.73       4.35
720  1520 105 5.04       5.75       4.33
721  1521 107 5.00       5.70       4.31
722  1522 103 5.03       5.71       4.35
723  1523 109 4.89       5.60       4.18
724  1524 109 4.86       5.61       4.12
725  1525 104 4.95       5.68       4.22
726  1526 113 4.80       5.57       4.04
727  1527 105 5.01       5.81       4.21
728  1528 106 4.95       5.75       4.16
729  1529 107 5.06       5.89       4.23
730  1530 107 5.13       5.99       4.28
731  1531 103 5.18       6.07       4.30
732  1532 108 5.23       6.17       4.28
733  1533 111 5.31       6.31       4.31
734  1534 108 5.33       6.30       4.35
735  1535  95 5.26       6.22       4.31
736  1536 108 5.25       6.31       4.18
737  1537 108 5.24       6.31       4.18
738  1538 112 5.26       6.33       4.18
739  1539 120 5.35       6.45       4.24
740  1540 122 5.40       6.38       4.42
741  1541 109 5.51       6.38       4.64
742  1542 102 5.52       6.38       4.66
743  1543 119 5.50       6.42       4.59
744  1544 107 5.70       6.58       4.82
745  1545  97 5.74       6.66       4.81
746  1546 112 5.61       6.54       4.68
747  1547 104 5.73       6.67       4.79
748  1548 118 5.75       6.76       4.74
749  1549 117 5.89       6.81       4.96
750  1550 111 6.08       6.98       5.19
751  1551 109 6.13       6.98       5.28
752  1552 104 6.19       7.06       5.32
753  1553 119 6.13       6.99       5.27
754  1554  NA 6.24       7.01       5.47
755  1555 101 6.23       6.97       5.48
756  1556 120 6.17       6.91       5.44
757  1557  93 6.31       7.00       5.62
758  1558 111 6.17       6.77       5.58
759  1559  96 6.24       6.84       5.64
760  1560 100 6.18       6.71       5.65
761  1561 102 6.25       6.84       5.66
762  1562  99 6.29       6.92       5.65
763  1563  99 6.13       6.78       5.49
764  1564 109 6.18       6.96       5.39
765  1565 114 6.16       6.89       5.43
766  1566  97 6.28       6.94       5.63
767  1567 108 6.09       6.76       5.42
768  1568 106 6.09       6.76       5.43
769  1569  NA 6.13       6.80       5.46
770  1570 112 6.16       6.80       5.51
771  1571 108 6.35       7.04       5.67
772  1572 107 6.38       7.06       5.71
773  1573  NA 6.47       7.15       5.79
774  1574  98 6.54       7.22       5.86
775  1575  NA 6.45       7.13       5.77
776  1576 109 6.44       7.09       5.80
777  1577 100 6.45       7.10       5.81
778  1578  NA 6.41       7.07       5.75
779  1579 102 6.37       7.01       5.72
780  1580  97 6.29       6.95       5.63
781  1581 105 6.22       6.88       5.55
782  1582  NA 6.43       7.23       5.63
783  1583 108 6.41       7.18       5.65
784  1584 106 6.45       7.20       5.70
785  1585 105 6.40       7.15       5.65
786  1586 106 6.23       7.08       5.37
787  1587 105 6.21       7.08       5.35
788  1588 106 6.25       7.11       5.39
789  1589 105 6.39       7.26       5.52
790  1590 102 6.39       7.31       5.48
791  1591  94 6.32       7.24       5.39
792  1592  98 6.20       7.08       5.32
793  1593 113 6.05       6.94       5.16
794  1594  93 6.05       6.98       5.13
795  1595 111 6.05       6.91       5.19
796  1596 104 6.16       7.02       5.30
797  1597 114 6.15       7.04       5.26
798  1598 110 6.25       7.13       5.37
799  1599 103 6.22       7.15       5.29
800  1600 101 6.18       7.16       5.21
801  1601  93 6.12       7.13       5.11
802  1602 107 6.03       6.94       5.12
803  1603  99 6.15       7.06       5.24
804  1604  95 6.21       7.14       5.27
805  1605 105 6.19       7.18       5.20
806  1606 106 6.22       7.26       5.18
807  1607 110 6.21       7.24       5.19
808  1608  NA 6.25       7.23       5.28
809  1609 108 6.22       7.14       5.30
810  1610 110 6.27       7.18       5.36
811  1611  NA 6.19       7.13       5.25
812  1612  87 6.07       7.02       5.12
813  1613 106 5.78       6.60       4.95
814  1614 103 5.79       6.62       4.96
815  1615 110 5.83       6.67       4.99
816  1616 122 6.08       7.06       5.10
817  1617 107 6.20       7.09       5.31
818  1618 102 6.23       7.16       5.30
819  1619  93 6.21       7.13       5.29
820  1620  NA 6.08       6.97       5.20
821  1621 109 6.07       6.91       5.22
822  1622 106 6.09       6.92       5.26
823  1623 113 6.04       6.89       5.18
824  1624 112 6.15       7.01       5.29
825  1625  95 6.26       7.14       5.39
826  1626 100 6.15       6.95       5.35
827  1627  NA 6.08       6.90       5.27
828  1628 104 6.04       6.83       5.26
829  1629 112 6.03       6.84       5.21
830  1630  NA 6.05       6.92       5.18
831  1631  NA 6.17       7.00       5.34
832  1632 104 6.10       6.92       5.28
833  1633  98 6.09       6.91       5.27
834  1634  96 6.02       6.81       5.24
835  1635  97 5.86       6.63       5.09
836  1636  NA 5.74       6.49       5.00
837  1637 105 5.68       6.41       4.96
838  1638 105 5.63       6.37       4.90
839  1639 108 5.65       6.38       4.92
840  1640 103 5.71       6.44       4.97
841  1641 117 5.58       6.34       4.82
842  1642 114 5.64       6.42       4.86
843  1643 114 5.74       6.53       4.95
844  1644 105 5.75       6.65       4.85
845  1645  99 5.70       6.63       4.76
846  1646  87 5.66       6.51       4.81
847  1647 112 5.51       6.12       4.91
848  1648  NA 5.55       6.17       4.94
849  1649 104 5.48       6.11       4.85
850  1650 102 5.43       6.05       4.81
851  1651 107 5.35       5.96       4.74
852  1652 107 5.38       5.98       4.78
853  1653 112 5.37       5.98       4.77
854  1654 104 5.34       6.03       4.65
855  1655 104 5.32       5.98       4.66
856  1656 103 5.31       5.94       4.67
857  1657  NA 5.28       5.90       4.67
858  1658 108 5.22       5.83       4.61
859  1659  NA 5.32       5.95       4.68
860  1660 111 5.45       6.14       4.76
861  1661  93 5.53       6.22       4.84
862  1662 110 5.38       6.05       4.71
863  1663 105 5.40       6.06       4.75
864  1664 105 5.37       6.03       4.71
865  1665 112 5.24       5.91       4.57
866  1666 108 5.22       5.88       4.56
867  1667 112 5.19       5.85       4.53
868  1668 110 5.29       5.96       4.62
869  1669 104 5.41       6.12       4.70
870  1670 102 5.30       6.02       4.59
871  1671 116 5.21       5.92       4.50
872  1672 112 5.21       5.92       4.50
873  1673 105 5.29       6.00       4.58
874  1674 115 5.22       5.94       4.50
875  1675 111 5.28       6.00       4.55
876  1676 103 5.24       6.01       4.47
877  1677  96 5.17       5.93       4.41
878  1678 109 5.10       5.78       4.42
879  1679 114 5.13       5.81       4.45
880  1680 109 5.17       5.88       4.46
881  1681 110 5.16       5.90       4.42
882  1682 104 5.16       5.94       4.37
883  1683 108 5.19       5.95       4.43
884  1684 118 5.19       5.95       4.43
885  1685 106 5.27       6.03       4.52
886  1686 104 5.24       5.99       4.48
887  1687 104 5.33       6.07       4.58
888  1688 114 5.37       6.11       4.62
889  1689  97 5.49       6.23       4.75
890  1690  93 5.32       6.04       4.59
891  1691 103 5.32       6.12       4.52
892  1692 109 5.35       6.24       4.46
893  1693 107 5.39       6.29       4.49
894  1694 109 5.47       6.45       4.49
895  1695 120 5.49       6.45       4.52
896  1696 114 5.51       6.32       4.71
897  1697 111 5.53       6.27       4.79
898  1698 101 5.60       6.32       4.87
899  1699  97 5.55       6.30       4.80
900  1700 116 5.47       6.29       4.65
901  1701 112 5.58       6.33       4.82
902  1702 116 5.61       6.32       4.91
903  1703 103 5.70       6.33       5.08
904  1704 113 5.70       6.36       5.04
905  1705 109 5.82       6.47       5.18
906  1706 115 5.86       6.47       5.24
907  1707 111 6.08       6.74       5.43
908  1708 103 6.19       6.82       5.56
909  1709 106 6.12       6.76       5.49
910  1710  NA 6.06       6.73       5.40
911  1711  NA 6.03       6.67       5.38
912  1712  NA 5.98       6.61       5.35
913  1713 104 5.95       6.56       5.33
914  1714 108 6.01       6.62       5.39
915  1715 107 6.03       6.65       5.42
916  1716 110 6.01       6.65       5.37
917  1717  98 6.10       6.73       5.46
918  1718 102 6.11       6.74       5.49
919  1719 102 6.13       6.76       5.49
920  1720 114 6.05       6.69       5.41
921  1721  95 6.16       6.77       5.55
922  1722 100 6.01       6.60       5.43
923  1723 104 6.05       6.68       5.42
924  1724  99 5.95       6.59       5.30
925  1725 106 5.76       6.44       5.08
926  1726 116 5.74       6.42       5.05
927  1727 112 5.78       6.48       5.09
928  1728 104 5.89       6.59       5.19
929  1729 105 5.85       6.55       5.14
930  1730  NA 5.86       6.56       5.17
931  1731 104 6.01       6.73       5.28
932  1732 108 5.99       6.71       5.26
933  1733 107 5.95       6.69       5.21
934  1734 102 6.04       6.78       5.29
935  1735 101 6.00       6.74       5.25
936  1736 106 5.89       6.64       5.13
937  1737  93 5.94       6.69       5.18
938  1738 101 5.71       6.46       4.97
939  1739 110 5.67       6.41       4.94
940  1740 115 5.72       6.45       4.99
941  1741 109 5.82       6.53       5.11
942  1742 109 5.85       6.56       5.13
943  1743 108 5.93       6.64       5.21
944  1744  98 5.91       6.64       5.18
945  1745 105 5.90       6.61       5.18
946  1746 110 5.87       6.59       5.16
947  1747 101 5.93       6.64       5.21
948  1748  96 5.83       6.55       5.12
949  1749 100 5.83       6.56       5.10
950  1750 110 5.75       6.48       5.02
951  1751 103 5.93       6.75       5.12
952  1752 110 5.88       6.69       5.07
953  1753  96 5.94       6.74       5.14
954  1754 115 5.86       6.68       5.04
955  1755 120 5.92       6.67       5.17
956  1756 109 6.04       6.71       5.38
957  1757 112 6.08       6.74       5.42
958  1758 101 6.10       6.76       5.45
959  1759 109 6.05       6.70       5.41
960  1760 103 5.97       6.70       5.24
961  1761  89 6.00       6.72       5.29
962  1762 106 5.89       6.51       5.26
963  1763 112 5.89       6.51       5.26
964  1764  98 5.96       6.57       5.35
965  1765 106 5.82       6.43       5.21
966  1766 113 5.85       6.46       5.24
967  1767 101 6.00       6.61       5.38
968  1768 117 5.91       6.53       5.29
969  1769 105 6.04       6.62       5.46
970  1770 105 6.06       6.64       5.48
971  1771 104 6.06       6.64       5.48
972  1772 106 6.13       6.74       5.53
973  1773 100 6.10       6.71       5.49
974  1774 110 6.06       6.67       5.46
975  1775  99 6.22       6.87       5.57
976  1776 108 6.09       6.75       5.43
977  1777 104 6.02       6.71       5.32
978  1778 111 6.07       6.77       5.37
979  1779  96 6.11       6.80       5.41
980  1780 109 6.07       6.74       5.39
981  1781  91 6.06       6.74       5.38
982  1782 109 5.79       6.46       5.13
983  1783 103 5.81       6.48       5.14
984  1784 105 5.72       6.41       5.03
985  1785 108 5.66       6.37       4.96
986  1786 106 5.71       6.41       5.01
987  1787 105 5.67       6.39       4.96
988  1788 109 5.66       6.37       4.95
989  1789 106 5.69       6.41       4.98
990  1790 119 5.79       6.52       5.07
991  1791  99 5.88       6.60       5.16
992  1792 101 5.85       6.54       5.17
993  1793 106 5.81       6.48       5.13
994  1794 104 5.79       6.47       5.11
995  1795 113 5.70       6.41       4.99
996  1796 103 5.74       6.47       5.00
997  1797  97 5.76       6.47       5.05
998  1798 110 5.62       6.30       4.93
999  1799 103 5.60       6.32       4.88
1000 1800 103 5.58       6.28       4.88
1001 1801 105 5.48       6.20       4.76
1002 1802  96 5.41       6.15       4.66
1003 1803 110 5.31       5.98       4.64
1004 1804 104 5.30       5.99       4.61
1005 1805  93 5.23       5.92       4.53
1006 1806 114 5.05       5.64       4.46
1007 1807 116 5.07       5.68       4.47
1008 1808  98 5.14       5.76       4.51
1009 1809 107 4.94       5.57       4.32
1010 1810 100 4.96       5.57       4.36
1011 1811 110 4.90       5.45       4.35
1012 1812 120 5.03       5.62       4.44
1013 1813 107 5.15       5.71       4.58
1014 1814 113 5.15       5.71       4.60
1015 1815 111 5.25       5.82       4.69
1016 1816 103 5.37       5.96       4.79
1017 1817 110 5.34       5.92       4.76
1018 1818 106 5.41       6.00       4.82
1019 1819 106 5.46       6.09       4.84
1020 1820  95 5.44       6.06       4.82
1021 1821 109 5.37       6.03       4.72
1022 1822 102 5.34       5.97       4.71
1023 1823 106 5.34       6.02       4.65
1024 1824 108 5.38       6.11       4.64
1025 1825 114 5.44       6.22       4.66
1026 1826 109 5.47       6.17       4.77
1027 1827 100 5.48       6.16       4.79
1028 1828 113 5.44       6.18       4.71
1029 1829 112 5.47       6.14       4.80
1030 1830 105 5.46       6.08       4.84
1031 1831 114 5.50       6.18       4.83
1032 1832 113 5.48       6.10       4.86
1033 1833 107 5.44       6.05       4.82
1034 1834 111 5.45       6.07       4.84
1035 1835 112 5.58       6.23       4.94
1036 1836 112 5.67       6.32       5.03
1037 1837 111 5.77       6.41       5.14
1038 1838 109 5.84       6.47       5.21
1039 1839 120 5.87       6.50       5.25
1040 1840 105 6.06       6.64       5.48
1041 1841 107 6.07       6.65       5.49
1042 1842  96 6.08       6.69       5.48
1043 1843 106 6.01       6.58       5.45
1044 1844 106 6.00       6.57       5.43
1045 1845 102 6.03       6.60       5.46
1046 1846  98 5.94       6.52       5.36
1047 1847 107 5.89       6.45       5.33
1048 1848 102 5.95       6.52       5.38
1049 1849 100 5.96       6.54       5.37
1050 1850 109 5.86       6.44       5.28
1051 1851 102 5.83       6.41       5.26
1052 1852 113 5.88       6.50       5.26
1053 1853 102 5.93       6.51       5.35
1054 1854 102 5.86       6.44       5.28
1055 1855 101 5.76       6.35       5.17
1056 1856 111 5.69       6.28       5.11
1057 1857 108 5.71       6.29       5.14
1058 1858 104 5.72       6.29       5.15
1059 1859 110 5.67       6.25       5.10
1060 1860 113 5.79       6.38       5.20
1061 1861 100 5.92       6.50       5.33
1062 1862 117 5.78       6.39       5.17
1063 1863 118 5.86       6.46       5.25
1064 1864 105 6.04       6.64       5.45
1065 1865  97 6.02       6.65       5.40
1066 1866 102 5.94       6.51       5.37
1067 1867 101 5.90       6.45       5.35
1068 1868 104 5.83       6.37       5.30
1069 1869 105 5.88       6.42       5.35
1070 1870  99 5.91       6.45       5.38
1071 1871 104 5.88       6.42       5.34
1072 1872  NA 5.94       6.52       5.35
1073 1873 104 6.01       6.62       5.41
1074 1874 107 5.97       6.57       5.38
1075 1875 103 5.99       6.58       5.41
1076 1876 111 5.97       6.57       5.38
1077 1877 104 6.05       6.61       5.48
1078 1878 101 6.07       6.65       5.48
1079 1879 102 6.00       6.59       5.41
1080 1880 110 5.98       6.58       5.37
1081 1881 112 6.09       6.71       5.46
1082 1882  97 6.15       6.72       5.58
1083 1883 107 6.09       6.69       5.49
1084 1884 109 6.14       6.74       5.54
1085 1885 113 6.20       6.79       5.62
1086 1886 108 6.22       6.72       5.71
1087 1887 109 6.27       6.76       5.77
1088 1888 107 6.31       6.78       5.84
1089 1889 109 6.35       6.83       5.87
1090 1890  98 6.40       6.86       5.93
1091 1891  99 6.34       6.81       5.87
1092 1892 115 6.33       6.82       5.85
1093 1893 109 6.51       6.94       6.08
1094 1894  98 6.48       6.92       6.04
1095 1895  NA 6.38       6.81       5.95
1096 1896 106 6.33       6.76       5.90
1097 1897 106 6.32       6.77       5.86
1098 1898 108 6.30       6.79       5.82
1099 1899  99 6.35       6.85       5.86
1100 1900 102 6.40       6.86       5.95
1101 1901 102 6.37       6.83       5.92
1102 1902  98 6.34       6.80       5.89
1103 1903  99 6.27       6.70       5.84
1104 1904 108 6.22       6.63       5.81
1105 1905 105 6.28       6.69       5.87
1106 1906 105 6.22       6.67       5.78
1107 1907 103 6.27       6.72       5.82
1108 1908 102 6.32       6.77       5.86
1109 1909 108 6.30       6.75       5.84
1110 1910 104 6.28       6.75       5.81
1111 1911  98 6.32       6.79       5.84
1112 1912 105 6.32       6.83       5.82
1113 1913 103 6.36       6.87       5.85
1114 1914 102 6.38       6.92       5.85
1115 1915 102 6.38       6.94       5.81
1116 1916 112 6.42       7.05       5.79
1117 1917 103 6.47       7.01       5.93
1118 1918 104 6.47       7.03       5.92
1119 1919  NA 6.44       6.98       5.90
1120 1920 104 6.50       7.04       5.96
1121 1921  NA 6.55       7.12       5.98
1122 1922 101 6.55       7.09       6.02
1123 1923  97 6.55       7.11       6.00
1124 1924 111 6.55       7.17       5.93
1125 1925 108 6.68       7.27       6.08
1126 1926 108 6.76       7.34       6.18
1127 1927 107 6.80       7.33       6.27
1128 1928 107 6.88       7.39       6.36
1129 1929 103 7.02       7.60       6.45
1130 1930  95 7.10       7.71       6.49
1131 1931 105 7.06       7.72       6.40
1132 1932 105 7.09       7.71       6.46
1133 1933 106 7.12       7.72       6.53
1134 1934 104 7.19       7.76       6.62
1135 1935 102 7.13       7.67       6.60
1136 1936 111 7.18       7.73       6.63
1137 1937 100 7.31       7.80       6.83
1138 1938  98 7.32       7.82       6.83
1139 1939 104 7.29       7.79       6.79
1140 1940 110 7.27       7.75       6.79
1141 1941 100 7.39       7.82       6.95
1142 1942  96 7.40       7.83       6.96
1143 1943 101 7.38       7.82       6.94
1144 1944 100 7.40       7.84       6.95
1145 1945  NA 7.39       7.84       6.95
1146 1946  97 7.41       7.84       6.98
1147 1947 107 7.45       7.94       6.97
1148 1948 102 7.48       7.92       7.05
1149 1949 107 7.53       7.97       7.09
1150 1950  99 7.58       7.98       7.18
1151 1951  98 7.58       7.98       7.18
1152 1952 105 7.63       8.06       7.20
1153 1953 101 7.68       8.09       7.27
1154 1954  98 7.61       8.06       7.16
1155 1955  97 7.60       8.05       7.15
1156 1956  99 7.55       8.00       7.10
1157 1957 103 7.59       8.05       7.14
1158 1958  99 7.56       8.05       7.08
1159 1959  92 7.63       8.11       7.14
1160 1960  95 7.67       8.22       7.12
1161 1961  99 7.65       8.22       7.07
1162 1962 102 7.70       8.31       7.09
1163 1963 101 7.75       8.35       7.14
1164 1964  99 7.76       8.36       7.17
1165 1965 110 7.76       8.35       7.17
1166 1966  97 7.83       8.32       7.33
1167 1967  97 7.83       8.33       7.32
1168 1968  99 7.89       8.46       7.32
1169 1969 101 7.94       8.54       7.34
1170 1970 107 7.95       8.52       7.37
1171 1971  98 8.05       8.57       7.53
1172 1972  99 8.12       8.69       7.55
1173 1973  97 8.13       8.69       7.57
1174 1974  99 8.18       8.78       7.58
1175 1975 100 8.18       8.76       7.60
1176 1976  99 8.20       8.77       7.63
1177 1977  93 8.22       8.78       7.66
1178 1978 104 8.20       8.78       7.61
1179 1979  97 8.28       8.83       7.73
1180 1980 102 8.30       8.86       7.74
1181 1981  99   NA         NA         NA
1182 1982  93   NA         NA         NA
1183 1983  99   NA         NA         NA
1184 1984 109   NA         NA         NA
1185 1985  99   NA         NA         NA
1186 1986 102   NA         NA         NA
1187 1987  95   NA         NA         NA
1188 1988 106   NA         NA         NA
1189 1989  93   NA         NA         NA
1190 1990  88   NA         NA         NA
1191 1991  97   NA         NA         NA
1192 1992  94   NA         NA         NA
1193 1993  97   NA         NA         NA
1194 1994  99   NA         NA         NA
1195 1995  99   NA         NA         NA
1196 1996 103   NA         NA         NA
1197 1997  97   NA         NA         NA
1198 1998  91   NA         NA         NA
1199 1999  94   NA         NA         NA
1200 2000 100   NA         NA         NA
1201 2001  96   NA         NA         NA
1202 2002  91   NA         NA         NA
1203 2003  98   NA         NA         NA
1204 2004  92   NA         NA         NA
1205 2005  99   NA         NA         NA
1206 2006  98   NA         NA         NA
1207 2007  97   NA         NA         NA
1208 2008  95   NA         NA         NA
1209 2009  95   NA         NA         NA
1210 2010  95   NA         NA         NA
1211 2011  99   NA         NA         NA
1212 2012 101   NA         NA         NA
1213 2013  93   NA         NA         NA
1214 2014  94   NA         NA         NA
1215 2015  93   NA         NA         NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cherry, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> temp))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cherry Blossom temperature in March)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 73 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/EDA cherry blossoms-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="spline-model-cherry-blossom" class="level3">
<h3 class="anchored" data-anchor-id="spline-model-cherry-blossom">Spline Model Cherry Blossom</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cherry2 <span class="ot">&lt;-</span> cherry <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(temp))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>knot_list <span class="ot">&lt;-</span> <span class="fu">quantile</span>( cherry2<span class="sc">$</span>year, <span class="at">probs=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span>num_knots) )</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">bs</span>(cherry2<span class="sc">$</span>year,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">knots=</span>knot_list[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,num_knots)] ,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree=</span><span class="dv">4</span> , <span class="at">intercept=</span><span class="cn">TRUE</span> )</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>B_tib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(B) </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>B_tib_join <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cherry2, B_tib)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>B_tib_join_long <span class="ot">&lt;-</span> B_tib_join <span class="sc">%&gt;%</span> </span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span>,<span class="st">`</span><span class="at">3</span><span class="st">`</span>, <span class="st">`</span><span class="at">4</span><span class="st">`</span>,<span class="st">`</span><span class="at">5</span><span class="st">`</span>, <span class="st">`</span><span class="at">6</span><span class="st">`</span>,<span class="st">`</span><span class="at">7</span><span class="st">`</span>, <span class="st">`</span><span class="at">8</span><span class="st">`</span>,<span class="st">`</span><span class="at">9</span><span class="st">`</span>, <span class="st">`</span><span class="at">10</span><span class="st">`</span>,<span class="st">`</span><span class="at">11</span><span class="st">`</span>, <span class="st">`</span><span class="at">12</span><span class="st">`</span>,<span class="st">`</span><span class="at">13</span><span class="st">`</span>, <span class="st">`</span><span class="at">14</span><span class="st">`</span>, <span class="st">`</span><span class="at">15</span><span class="st">`</span>, <span class="st">`</span><span class="at">16</span><span class="st">`</span>, <span class="st">`</span><span class="at">17</span><span class="st">`</span>),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"knot"</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"density"</span>)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> B_tib_join_long, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> (density),  <span class="at">color =</span> <span class="fu">as.factor</span>(knot)))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type
&lt;bs/basis/matrix&gt;. Defaulting to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/Model Creation cherry-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>b4_smooth <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cherry2,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> temp <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(year, <span class="at">bs =</span> <span class="st">"bs"</span>, <span class="at">k =</span> <span class="dv">30</span>),  <span class="co"># k sets number of basis functions</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sds),      <span class="co"># Prior for smooth term</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/b04.cherry_bspline"</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.1</span>_smooth <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cherry2,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> temp <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(year, <span class="at">bs =</span> <span class="st">"tp"</span>),  <span class="co"># k sets number of basis functions</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sds),      <span class="co"># Prior for smooth term</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/b04.cherry_thinSpline"</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>year_seq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">800</span>, <span class="at">to =</span> <span class="dv">2000</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>mu_temp_4 <span class="ot">&lt;-</span></span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4_smooth, </span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> year_seq) <span class="sc">%&gt;%</span></span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let's tack on the `weight` values from `weight_seq`</span></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(year_seq)</span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>pred_temp_4 <span class="ot">&lt;-</span></span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(b4_smooth,</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> year_seq) <span class="sc">%&gt;%</span></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(year_seq)</span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_temp_4 %&gt;%</span></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1:6)</span></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a>mu_temp_4<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4<span class="fl">.1</span>_smooth, </span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> year_seq) <span class="sc">%&gt;%</span></span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let's tack on the `weight` values from `weight_seq`</span></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(year_seq)</span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a>pred_temp_4<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(b4<span class="fl">.1</span>_smooth,</span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> year_seq) <span class="sc">%&gt;%</span></span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(year_seq)</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_temp_4.1 %&gt;%</span></span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1:6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plots-cherry-blossom" class="level3">
<h3 class="anchored" data-anchor-id="plots-cherry-blossom">Plots Cherry Blossom</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>cherry2 <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_temp_4, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey83"</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> mu_temp_4,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">"identity"</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> temp),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"navyblue"</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"temp"</span>) <span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"15 knot B-splines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/Visuals cherry-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cherry2 <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_temp_4<span class="fl">.1</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey83"</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> mu_temp_4<span class="fl">.1</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">"identity"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"grey70"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> temp),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"navyblue"</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"temp"</span>) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thin Plated Spline"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_line(aes(y = temp), color = "navyblue", shape = 1): Ignoring
unknown parameters: `shape`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/Visuals cherry-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I am confused as to why the the Thin plated splines don't go more crazy and try to fit all of the contours </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="hard-questions" class="level1">
<h1>Hard Questions</h1>
<section id="h1" class="level3">
<h3 class="anchored" data-anchor-id="h1">4H1</h3>
<p>The weights listed below were recorded in the !Kung census,but heights were not recorded for these individuals. Provide predicted heights and 89% intervals for each of these individuals. That is, fill in the table below, using model-based predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.3</span> <span class="ot">&lt;-</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> kHeight, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight_s,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="at">class =</span> sigma, <span class="at">ub =</span> <span class="dv">8</span>)),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">"fits/b04.03.2"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.8</span>_smooth <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> kHeight,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(weight_s, <span class="at">bs =</span> <span class="st">"tp"</span>),  <span class="co"># k sets number of basis functions</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sds),      <span class="co"># Prior for smooth term</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">4</span>), <span class="at">class =</span> sigma)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/b04.08.1"</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>new_weight_seq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight_c =</span> <span class="fu">c</span>(<span class="fl">46.95</span>, <span class="fl">43.72</span>, <span class="fl">64.78</span>, <span class="fl">32.59</span>, <span class="fl">54.63</span>) <span class="sc">-</span> <span class="fu">mean</span>(kHeight<span class="sc">$</span>weight))</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>mu_4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">fitted</span>(b4<span class="fl">.3</span>, <span class="at">summary =</span> F)</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>mu_4<span class="fl">.3</span>  <span class="ot">&lt;-</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b4<span class="fl">.3</span>,</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> new_weight_seq) <span class="sc">%&gt;%</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="fl">46.95</span>, <span class="fl">43.72</span>, <span class="fl">64.78</span>, <span class="fl">32.59</span>, <span class="fl">54.63</span>) <span class="sc">-</span> <span class="fu">mean</span>(kHeight<span class="sc">$</span>weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>mu_4<span class="fl">.3</span> <span class="ot">&lt;-</span>  mu_4<span class="fl">.3</span> <span class="sc">%&gt;%</span></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(weight, height, <span class="sc">-</span>iter) <span class="sc">%&gt;%</span> </span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we might reformat `weight` to numerals</span></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> <span class="fu">as.numeric</span>(weight))</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> mu_4<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height), <span class="at">alpha =</span> .<span class="dv">002</span>, <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> kHeight, <span class="fu">aes</span>(<span class="at">x =</span> weight_s, <span class="at">y =</span> height))<span class="sc">+</span></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(kHeight<span class="sc">$</span>weight)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch4_linear_regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>